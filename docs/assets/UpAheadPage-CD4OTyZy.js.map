{"version":3,"file":"UpAheadPage-CD4OTyZy.js","sources":["../../src/hooks/useWatchlist.js","../../src/utils/calendar.js","../../src/utils/dateExtractor.js","../../src/utils/plannerStorage.js","../../src/services/upAheadService.js","../../src/pages/UpAheadPage.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\n\nexport function useWatchlist(storageKey = 'ua_watchlist') {\n    const [watchlist, setWatchlist] = useState(() => {\n        try {\n            return JSON.parse(localStorage.getItem(storageKey)) || [];\n        } catch {\n            return [];\n        }\n    });\n\n    const toggleWatchlist = (id) => {\n        let newWatchlist;\n        if (watchlist.includes(id)) {\n            newWatchlist = watchlist.filter(itemId => itemId !== id);\n        } else {\n            newWatchlist = [...watchlist, id];\n        }\n        setWatchlist(newWatchlist);\n        localStorage.setItem(storageKey, JSON.stringify(newWatchlist));\n    };\n\n    const isWatched = (id) => watchlist.includes(id);\n\n    return { watchlist, toggleWatchlist, isWatched };\n}\n","export const downloadCalendarEvent = (title, description) => {\n    // Current time as start, duration 1 hour (default)\n    const now = new Date();\n    const start = now.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';\n    const end = new Date(now.getTime() + 60 * 60 * 1000).toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';\n\n    const eventText = `BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nSUMMARY:${title}\nDESCRIPTION:${description}\nDTSTART:${start}\nDTEND:${end}\nEND:VEVENT\nEND:VCALENDAR`;\n\n    const blob = new Blob([eventText], { type: 'text/calendar' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `${title.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.ics`;\n    a.click();\n    URL.revokeObjectURL(url);\n};\n","/**\n * 5-Layer Date Extraction Engine for Up Ahead.\n *\n * Layers (tried in order, first match wins):\n *   1. ISO / numeric dates  ‚Äî \"2026-02-14\", \"14/02/2026\"\n *   2. Named dates          ‚Äî \"February 14\", \"Feb 14, 2026\", \"14th February\"\n *   3. Date ranges          ‚Äî \"Feb 10 to Feb 24\", \"10-24 February\"\n *   4. Relative dates       ‚Äî \"tomorrow\", \"next week\", \"this Friday\"\n *   5. Deadline detection   ‚Äî \"ends Feb 12\", \"last date March 1\"\n *\n * All functions return { start: Date, end: Date | null, type: string } or null.\n */\n\nexport const DATE_EXTRACTION_PATTERNS = [\n    { type: 'iso', label: 'ISO / Numeric', example: '2026-02-14, 14/02/2026' },\n    { type: 'named', label: 'Named Dates', example: 'February 14, 14th Feb' },\n    { type: 'range', label: 'Date Ranges', example: 'Feb 10-24, 10th to 12th March' },\n    { type: 'relative', label: 'Relative', example: 'Tomorrow, Next Friday, This Weekend' },\n    { type: 'deadline', label: 'Deadline', example: 'Ends on Feb 12, Last date March 1' }\n];\n\nconst MONTHS = {\n    jan: 0, january: 0,\n    feb: 1, february: 1,\n    mar: 2, march: 2,\n    apr: 3, april: 3,\n    may: 4,\n    jun: 5, june: 5,\n    jul: 6, july: 6,\n    aug: 7, august: 7,\n    sep: 8, september: 8,\n    oct: 9, october: 9,\n    nov: 10, november: 10,\n    dec: 11, december: 11\n};\n\nconst DAYS = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];\n\n// Pre-compiled Regexes\nconst MONTH_NAMES_REGEX_STR = Object.keys(MONTHS).filter(m => m.length > 2).join('|');\nconst ISO_REGEX = /\\b(\\d{4})-(\\d{1,2})-(\\d{1,2})\\b/;\nconst DMY_REGEX = /\\b(\\d{1,2})[/-](\\d{1,2})[/-](\\d{4})\\b/;\nconst NAMED_REGEX_1 = new RegExp(`\\\\b(${MONTH_NAMES_REGEX_STR})[-\\\\s]+(\\\\d{1,2})(?:st|nd|rd|th)?(?:[,\\\\s-]+(\\\\d{4}))?\\\\b`, 'i');\nconst NAMED_REGEX_2 = new RegExp(`\\\\b(\\\\d{1,2})(?:st|nd|rd|th)?[-\\\\s]+(${MONTH_NAMES_REGEX_STR})(?:[-\\\\s,]+(\\\\d{4}))?\\\\b`, 'i');\nconst RANGE_REGEX_1 = new RegExp(`\\\\b(${MONTH_NAMES_REGEX_STR})[-\\\\s]+(\\\\d{1,2})(?:st|nd|rd|th)?\\\\s*(?:to|‚Äì|-|through)\\\\s*(${MONTH_NAMES_REGEX_STR})[-\\\\s]+(\\\\d{1,2})(?:st|nd|rd|th)?\\\\b`, 'i');\nconst RANGE_REGEX_2 = new RegExp(`\\\\b(${MONTH_NAMES_REGEX_STR})[-\\\\s]+(\\\\d{1,2})(?:st|nd|rd|th)?\\\\s*(?:to|‚Äì|-|through)\\\\s*(\\\\d{1,2})(?:st|nd|rd|th)?\\\\b`, 'i');\nconst RANGE_REGEX_3 = new RegExp(`\\\\b(\\\\d{1,2})(?:st|nd|rd|th)?\\\\s*(?:to|‚Äì|-)\\\\s*(\\\\d{1,2})(?:st|nd|rd|th)?[-\\\\s]+(${MONTH_NAMES_REGEX_STR})\\\\b`, 'i');\nconst RELATIVE_NEXT_N_REGEX = /\\bnext\\s+(\\d+)\\s+(day|week)s?\\b/;\nconst DEADLINE_REGEX = new RegExp(\n    `\\\\b(?:ends?|last date|deadline|valid (?:till|until)|expires?|before)\\\\s+(?:on\\\\s+)?` +\n    `(${MONTH_NAMES_REGEX_STR})\\\\s+(\\\\d{1,2})(?:st|nd|rd|th)?(?:[,\\\\s]+(\\\\d{4}))?\\\\b`,\n    'i'\n);\n\nfunction monthNum(str) {\n    return MONTHS[str.toLowerCase().slice(0, 3)] ?? null;\n}\n\nfunction inferYear(month, day, ref) {\n    const d = new Date(ref.getFullYear(), month, day);\n    // If the inferred date is more than 30 days in the past, push to next year\n    if (d < ref && (ref - d) > 30 * 86400000) {\n        d.setFullYear(d.getFullYear() + 1);\n    }\n    return d;\n}\n\n// Layer 1: ISO and numeric dates\nfunction extractISO(text, ref) {\n    // ISO: 2026-02-14\n    const iso = text.match(ISO_REGEX);\n    if (iso) {\n        return { start: new Date(+iso[1], +iso[2] - 1, +iso[3]), end: null, type: 'iso' };\n    }\n    // DD/MM/YYYY or DD-MM-YYYY\n    const dmy = text.match(DMY_REGEX);\n    if (dmy) {\n        return { start: new Date(+dmy[3], +dmy[2] - 1, +dmy[1]), end: null, type: 'numeric' };\n    }\n    return null;\n}\n\n// Layer 2: Named dates ‚Äî \"February 14\", \"14th Feb\", \"Feb 14, 2026\"\nfunction extractNamed(text, ref) {\n    // \"Month Day[, Year]\"\n    const m1 = text.match(NAMED_REGEX_1);\n    if (m1) {\n        const mo = monthNum(m1[1]);\n        const day = +m1[2];\n        const yr = m1[3] ? +m1[3] : null;\n        const d = yr ? new Date(yr, mo, day) : inferYear(mo, day, ref);\n        return { start: d, end: null, type: 'named' };\n    }\n    // \"Day[th] Month [Year]\"\n    const m2 = text.match(NAMED_REGEX_2);\n    if (m2) {\n        const mo = monthNum(m2[2]);\n        const day = +m2[1];\n        const yr = m2[3] ? +m2[3] : null;\n        const d = yr ? new Date(yr, mo, day) : inferYear(mo, day, ref);\n        return { start: d, end: null, type: 'named' };\n    }\n    return null;\n}\n\n// Layer 3: Date ranges ‚Äî \"Feb 10 to Feb 24\", \"10-24 February\"\nfunction extractRange(text, ref) {\n    // \"Month Day to/- Month Day\"\n    const m1 = text.match(RANGE_REGEX_1);\n    if (m1) {\n        return {\n            start: inferYear(monthNum(m1[1]), +m1[2], ref),\n            end: inferYear(monthNum(m1[3]), +m1[4], ref),\n            type: 'range'\n        };\n    }\n    // \"Month Day to Day\" (same month)\n    const m2 = text.match(RANGE_REGEX_2);\n    if (m2) {\n        const mo = monthNum(m2[1]);\n        return {\n            start: inferYear(mo, +m2[2], ref),\n            end: inferYear(mo, +m2[3], ref),\n            type: 'range'\n        };\n    }\n    // \"Day-Day Month\"\n    const m3 = text.match(RANGE_REGEX_3);\n    if (m3) {\n        const mo = monthNum(m3[3]);\n        return {\n            start: inferYear(mo, +m3[1], ref),\n            end: inferYear(mo, +m3[2], ref),\n            type: 'range'\n        };\n    }\n    return null;\n}\n\n// Layer 4: Relative dates ‚Äî \"tomorrow\", \"this Friday\", \"next week\"\nfunction extractRelative(text, ref) {\n    const lower = text.toLowerCase();\n\n    // Optimization: Quick fail if no \"relative\" words exist\n    if (!/tomorrow|today|next|this|week|weekend/.test(lower)) return null;\n\n    if (/\\btomorrow\\b/.test(lower)) {\n        const d = new Date(ref);\n        d.setDate(d.getDate() + 1);\n        return { start: d, end: null, type: 'relative' };\n    }\n    if (/\\btoday\\b/.test(lower)) {\n        return { start: new Date(ref), end: null, type: 'relative' };\n    }\n\n    // \"next N days/weeks\"\n    const nextN = lower.match(RELATIVE_NEXT_N_REGEX);\n    if (nextN) {\n        const n = +nextN[1];\n        const unit = nextN[2] === 'week' ? 7 : 1;\n        const end = new Date(ref);\n        end.setDate(end.getDate() + n * unit);\n        return { start: new Date(ref), end, type: 'relative' };\n    }\n\n    // \"next week\"\n    if (/\\bnext week\\b/.test(lower)) {\n        const start = new Date(ref);\n        start.setDate(start.getDate() + (7 - start.getDay() + 1)); // next Monday\n        const end = new Date(start);\n        end.setDate(end.getDate() + 6);\n        return { start, end, type: 'relative' };\n    }\n\n    // \"this/next Friday\"\n    // Loop optimized by checking inclusion first\n    for (let i = 0; i < DAYS.length; i++) {\n        if (!lower.includes(DAYS[i])) continue;\n        const dayRe = new RegExp(`\\\\b(?:this|next|coming)\\\\s+${DAYS[i]}\\\\b`, 'i');\n        if (dayRe.test(text)) {\n            const d = new Date(ref);\n            let diff = (i - d.getDay() + 7) % 7;\n            if (diff === 0) diff = 7; // if today is that day, assume next occurrence\n            d.setDate(d.getDate() + diff);\n            return { start: d, end: null, type: 'relative' };\n        }\n    }\n\n    // \"this weekend\"\n    if (/\\bthis weekend\\b/.test(lower)) {\n        const sat = new Date(ref);\n        sat.setDate(sat.getDate() + (6 - sat.getDay() + 7) % 7);\n        const sun = new Date(sat);\n        sun.setDate(sun.getDate() + 1);\n        return { start: sat, end: sun, type: 'relative' };\n    }\n\n    return null;\n}\n\n// Layer 5: Deadline detection ‚Äî \"ends Feb 12\", \"last date March 1\", \"deadline\"\nfunction extractDeadline(text, ref) {\n    const m = text.match(DEADLINE_REGEX);\n    if (m) {\n        const mo = monthNum(m[1]);\n        const day = +m[2];\n        const yr = m[3] ? +m[3] : null;\n        const d = yr ? new Date(yr, mo, day) : inferYear(mo, day, ref);\n        return { start: new Date(ref), end: d, type: 'deadline' };\n    }\n    return null;\n}\n\n/**\n * Main entry point. Extracts dates from text using all 5 layers.\n * @param {string} text - Article title + description\n * @param {Date|string} [pubDate] - Publication date for context\n * @returns {{ start: Date, end: Date|null, type: string } | null}\n */\nexport function extractDate(text, pubDate) {\n    if (!text) return null;\n    const ref = pubDate ? new Date(pubDate) : new Date();\n    if (isNaN(ref.getTime())) return null;\n\n    // Prioritize Range and Deadline over simple Named dates to capture \"Feb 10-20\" or \"Ends Feb 10\" correctly\n    return (\n        extractISO(text, ref) ||\n        extractRange(text, ref) ||\n        extractDeadline(text, ref) ||\n        extractNamed(text, ref) ||\n        extractRelative(text, ref)\n    );\n}\n\n/**\n * Expand a date result into an array of date keys (YYYY-MM-DD) for multi-day events.\n * @param {{ start: Date, end: Date|null }} dateResult\n * @param {number} [maxDays=14] - Safety cap\n * @returns {string[]}\n */\nexport function expandDateKeys(dateResult, maxDays = 14) {\n    if (!dateResult?.start) return [];\n    const keys = [];\n    const start = new Date(dateResult.start);\n    start.setHours(0, 0, 0, 0);\n    const end = dateResult.end ? new Date(dateResult.end) : new Date(start);\n    end.setHours(0, 0, 0, 0);\n\n    let d = new Date(start);\n    while (d <= end && keys.length < maxDays) {\n        keys.push(d.toISOString().slice(0, 10));\n        d.setDate(d.getDate() + 1);\n    }\n    return keys;\n}\n","const PLANNER_KEY = 'upAhead_planner';\nconst BLACKLIST_KEY = 'upAhead_blacklist';\nconst API_BASE = '/api';\n\nconst plannerStorage = {\n    // ========================================\n    // SYNC WITH SERVER\n    // ========================================\n    sync: async () => {\n        try {\n            // Sync Blacklist\n            const blResponse = await fetch(`${API_BASE}/blacklist`);\n            if (blResponse.ok) {\n                const remoteBlacklist = await blResponse.json();\n                // Merge with local? Or overwrite?\n                // Overwrite is safer for \"single source of truth\".\n                // But let's Union to be safe against data loss during offline usage.\n                const localBlacklist = plannerStorage.getBlacklist();\n                const merged = new Set([...localBlacklist, ...remoteBlacklist]);\n                localStorage.setItem(BLACKLIST_KEY, JSON.stringify([...merged]));\n            }\n\n            // Sync Planner\n            const planResponse = await fetch(`${API_BASE}/user_plan`);\n            if (planResponse.ok) {\n                const remotePlan = await planResponse.json();\n                const localPlanRaw = localStorage.getItem(PLANNER_KEY);\n                const localPlan = localPlanRaw ? JSON.parse(localPlanRaw) : {};\n\n                // Merge strategies:\n                // For now, let's assume remote is master for simplicity, but merge keys.\n                const mergedPlan = { ...localPlan, ...remotePlan };\n                localStorage.setItem(PLANNER_KEY, JSON.stringify(mergedPlan));\n            }\n            console.log('[PlannerStorage] Synced with server');\n        } catch (e) {\n            console.warn('[PlannerStorage] Sync failed', e);\n        }\n    },\n\n    getUpcomingDays: (days = 14) => {\n        try {\n            const data = localStorage.getItem(PLANNER_KEY);\n            if (!data) return [];\n\n            const parsed = JSON.parse(data);\n            const today = new Date().toISOString().split('T')[0];\n\n            // Filter out past days\n            const validDays = Object.entries(parsed)\n                .filter(([date]) => date >= today)\n                .sort((a, b) => a[0].localeCompare(b[0]))\n                .slice(0, days)\n                .map(([date, items]) => ({\n                    date,\n                    items\n                }));\n\n            return validDays;\n        } catch (e) {\n            console.error('Failed to read planner storage', e);\n            return [];\n        }\n    },\n\n    addItem: (date, item) => {\n        try {\n            const data = localStorage.getItem(PLANNER_KEY);\n            const parsed = data ? JSON.parse(data) : {};\n\n            if (!parsed[date]) parsed[date] = [];\n\n            // Avoid duplicates\n            if (!parsed[date].some(i => i.id === item.id)) {\n                parsed[date].push(item);\n                localStorage.setItem(PLANNER_KEY, JSON.stringify(parsed));\n\n                // Persist to API\n                plannerStorage.savePlanToApi(parsed);\n                return true;\n            }\n            return false;\n        } catch (e) {\n            console.error('Failed to add item to planner', e);\n            return false;\n        }\n    },\n\n    removeItem: (date, itemId) => {\n         try {\n            const data = localStorage.getItem(PLANNER_KEY);\n            const parsed = data ? JSON.parse(data) : {};\n\n            if (parsed[date]) {\n                parsed[date] = parsed[date].filter(i => i.id !== itemId);\n                if (parsed[date].length === 0) delete parsed[date];\n\n                localStorage.setItem(PLANNER_KEY, JSON.stringify(parsed));\n                plannerStorage.savePlanToApi(parsed);\n                return true;\n            }\n            return false;\n        } catch (e) {\n            console.error('Failed to remove item', e);\n            return false;\n        }\n    },\n\n    merge: (dates, newItems) => {\n        try {\n            const data = localStorage.getItem(PLANNER_KEY);\n            const parsed = data ? JSON.parse(data) : {};\n            let changed = false;\n\n            dates.forEach(date => {\n                if (!parsed[date]) parsed[date] = [];\n                const existingIds = new Set(parsed[date].map(i => i.id));\n\n                newItems.forEach(item => {\n                    if (!existingIds.has(item.id)) {\n                        parsed[date].push(item);\n                        changed = true;\n                    }\n                });\n            });\n\n            if (changed) {\n                localStorage.setItem(PLANNER_KEY, JSON.stringify(parsed));\n                plannerStorage.savePlanToApi(parsed);\n            }\n        } catch (e) {\n            console.error('Merge failed', e);\n        }\n    },\n\n    savePlanToApi: async (planData) => {\n        try {\n            await fetch(`${API_BASE}/user_plan`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(planData)\n            });\n        } catch (e) {\n            console.warn('API save plan error:', e);\n        }\n    },\n\n    // Blacklist Management\n    addToBlacklist: (id) => {\n        try {\n            const list = JSON.parse(localStorage.getItem(BLACKLIST_KEY) || '[]');\n            if (!list.includes(id)) {\n                list.push(id);\n                localStorage.setItem(BLACKLIST_KEY, JSON.stringify(list));\n\n                // Persist to API\n                plannerStorage.saveBlacklistToApi(list);\n            }\n        } catch (e) {\n            console.error('Failed to blacklist', e);\n        }\n    },\n\n    getBlacklist: () => {\n        try {\n            return new Set(JSON.parse(localStorage.getItem(BLACKLIST_KEY) || '[]'));\n        } catch {\n            return new Set();\n        }\n    },\n\n    saveBlacklistToApi: async (list) => {\n        try {\n             await fetch(`${API_BASE}/blacklist`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(list)\n            });\n        } catch (e) {\n             console.warn('API save blacklist error:', e);\n        }\n    }\n};\n\nexport default plannerStorage;\n","import { proxyManager } from './proxyManager.js';\nimport logStore from '../utils/logStore.js';\nimport { extractDate, expandDateKeys } from '../utils/dateExtractor.js';\nimport plannerStorage from '../utils/plannerStorage.js';\nimport { DEFAULT_SETTINGS } from '../utils/storage.js';\n\nexport const CACHE_KEY = 'upAhead_cache';\n\n// ============================================================\n// CACHE MANAGEMENT\n// ============================================================\n\nexport function loadFromCache() {\n    try {\n        const cached = localStorage.getItem(CACHE_KEY);\n        if (cached) {\n            const data = JSON.parse(cached);\n            // Optional: Check if cache is too old (e.g. > 8 hours)\n            // But requirement says \"show stale data if less than 8hrs\", implying we show it anyway?\n            // \"Loading phase 1: Load ... with showing stale data if less than 8hrs.\"\n            // If it's older than 8 hours, maybe we shouldn't show it?\n            // Let's return it with a timestamp check.\n            const age = Date.now() - (new Date(data.lastUpdated || 0).getTime());\n            if (age > 8 * 60 * 60 * 1000) {\n                 console.log('[UpAheadService] Cache is older than 8 hours.');\n                 // We still return it, but maybe mark it?\n                 // User said \"show stale data if less than 8hrs\".\n                 // If > 8hrs, maybe return null?\n                 // \"some time I doubt even if its working since it shows blank page for very long time.\"\n                 // Showing *something* is better than nothing.\n            }\n            return data;\n        }\n    } catch (e) {\n        console.warn('Cache read error', e);\n    }\n    return null;\n}\n\nexport function saveToCache(data) {\n    try {\n        localStorage.setItem(CACHE_KEY, JSON.stringify(data));\n    } catch (e) {\n        console.warn('Cache write error', e);\n    }\n}\n\n// ============================================================\n// SMART KEYWORD FILTERS FOR PLANNING\n// ============================================================\n\n// Word-boundary matching\nconst _wbCache = new Map();\nfunction matchesWord(text, word) {\n    let re = _wbCache.get(word);\n    if (!re) {\n        const escaped = word.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        re = new RegExp(`\\\\b${escaped}\\\\b`, 'i');\n        _wbCache.set(word, re);\n    }\n    return re.test(text);\n}\n\nfunction hash(value) {\n    let h = 0;\n    if (!value) return \"0\";\n    for (let i = 0; i < value.length; i++) {\n        h = (h << 5) - h + value.charCodeAt(i);\n        h |= 0;\n    }\n    return h.toString();\n}\n\nfunction generateCanonicalId(title, dateStr) {\n    const slug = title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');\n    return hash(`${slug}-${dateStr}`);\n}\n\nfunction matchesKeyword(text, keyword) {\n    const lowerText = text.toLowerCase();\n    const lowerKeyword = keyword.toLowerCase();\n    if (keyword.includes(' ')) {\n        return lowerText.includes(lowerKeyword);\n    }\n    return matchesWord(lowerText, lowerKeyword);\n}\n\n// Configuration for search queries based on categories\nconst CATEGORY_QUERIES = {\n    movies: [\n        'Tamil movie release this week',\n        'new movie release OTT',\n        'BookMyShow Chennai movies',\n        'upcoming movies Kollywood',\n        'movie tickets showtimes'\n    ],\n    events: [\n        'Chennai events this week',\n        'LiveChennai events',\n        'concert tickets Chennai',\n        'standup comedy show Chennai',\n        'exhibition workshops Chennai',\n        'things to do Chennai weekend',\n        'Muscat events this week',\n        'Muscat concerts exhibitions',\n        'theatre shows Chennai this week',\n        'art exhibition Chennai',\n        'food festival Chennai',\n        'cultural event Chennai',\n        'music sabha Chennai',\n        'Muscat Royal Opera House events'\n    ],\n    festivals: [\n        'Maha Shivaratri 2025 date',\n        'upcoming festivals Tamil Nadu 2025',\n        'bank holidays India upcoming',\n        'public holidays Tamil Nadu',\n        'religious festivals this month India',\n        'Oman festivals holidays'\n    ],\n    alerts: [\n        'TANGEDCO power cut Chennai tomorrow',\n        'TNEB power shutdown schedule',\n        'Chennai traffic advisory today',\n        'Chennai metro maintenance',\n        'water supply disruption Chennai',\n        'road closure Chennai'\n    ],\n    weather_alerts: [\n        'IMD Chennai weather warning',\n        'Tamil Nadu heavy rain alert',\n        'cyclone warning Chennai',\n        'heat wave advisory Tamil Nadu',\n        'Oman weather warning Muscat'\n    ],\n    sports: [\n        'IPL 2026 schedule matches',\n        'cricket match Chennai CSK',\n        'ISL football match schedule',\n        'Pro Kabaddi schedule',\n        'sports events Chennai this week'\n    ],\n    shopping: [\n        'Chennai sale offers discount today',\n        'exhibition sale Chennai',\n        'Pongal sale Tamil Nadu',\n        'Diwali offers Chennai',\n        'end of season sale Chennai mall',\n        'Muscat shopping festival offers'\n    ],\n    airlines: [\n        'Oman Air flight offers',\n        'Indigo Airlines offers',\n        'Salam Air ticket offers',\n        'Air India sale',\n        'flight ticket offers India'\n    ],\n    civic: [\n        'VIP visit Chennai road closure',\n        'minister visit Tamil Nadu traffic',\n        'protest bandh Chennai tomorrow',\n        'Chennai corporation announcement',\n        'Muscat road closure traffic'\n    ]\n};\n\nconst STATIC_FEEDS = {\n    movies: [\n        \"https://www.hindustantimes.com/feeds/rss/entertainment/tamil-cinema/rssfeed.xml\",\n        \"https://www.hindustantimes.com/feeds/rss/entertainment/bollywood/rssfeed.xml\"\n    ],\n    sports: [\n        \"https://www.espn.com/espn/rss/news\"\n    ],\n    festivals: [\n        \"https://www.timeanddate.com/holidays/india/feed\"\n    ],\n    events: [\n        \"https://www.thehindu.com/news/cities/chennai/feeder/default.rss\"\n    ]\n};\n\nexport async function fetchStaticUpAheadData() {\n    try {\n        const baseUrl = import.meta.env.BASE_URL;\n        const cleanBase = baseUrl.endsWith('/') ? baseUrl : baseUrl + '/';\n        const url = `${cleanBase}data/up_ahead.json`;\n\n        const response = await fetch(url);\n        if (!response.ok) {\n            console.warn(`[UpAheadService] Static fetch failed: ${response.status}`);\n            return null;\n        }\n        const data = await response.json();\n        if (data.error) {\n             console.warn(`[UpAheadService] Static data has error: ${data.error}`);\n             return null;\n        }\n        return data;\n    } catch (e) {\n        console.error(`[UpAheadService] Static fetch exception:`, e);\n        return null;\n    }\n}\n\nexport function mergeUpAheadData(baseData, newData) {\n    if (!baseData) return newData;\n    if (!newData) return baseData;\n\n    const merged = { ...baseData };\n\n    // 1. Merge Timeline\n    const timelineMap = new Map();\n    if (baseData.timeline) {\n        baseData.timeline.forEach(day => {\n             timelineMap.set(day.date, { ...day, items: [...(day.items || [])] });\n        });\n    }\n\n    if (newData.timeline) {\n        newData.timeline.forEach(day => {\n            if (!timelineMap.has(day.date)) {\n                timelineMap.set(day.date, day);\n            } else {\n                const existingDay = timelineMap.get(day.date);\n                const existingIds = new Set(existingDay.items.map(i => i.id));\n                day.items.forEach(item => {\n                    if (!existingIds.has(item.id)) {\n                        existingDay.items.push(item);\n                        existingIds.add(item.id);\n                    }\n                });\n            }\n        });\n    }\n    merged.timeline = Array.from(timelineMap.values()).sort((a,b) => a.date.localeCompare(b.date));\n\n    // 2. Merge Sections\n    if (newData.sections) {\n        if (!merged.sections) merged.sections = {};\n        Object.keys(newData.sections).forEach(key => {\n            const existing = merged.sections[key] || [];\n            const newItems = newData.sections[key] || [];\n            const existingTitles = new Set(existing.map(i => i.title));\n            const combined = [...existing];\n\n            newItems.forEach(item => {\n                if (!existingTitles.has(item.title)) {\n                    combined.push(item);\n                    existingTitles.add(item.title);\n                }\n            });\n            merged.sections[key] = combined;\n        });\n    }\n\n    // 3. Regenerate Weekly Plan based on merged timeline\n    // Note: We use settings blacklist if handled externally, or regenerate in UI\n    merged.weekly_plan = generateWeeklyPlan(merged.timeline, new Set()); // Blacklist handled in UI or reload\n    merged.lastUpdated = newData.lastUpdated || baseData.lastUpdated;\n\n    return merged;\n}\n\n\nexport async function fetchLiveUpAheadData(settings) {\n    const _t0 = Date.now();\n    console.log('[UpAheadService] Fetching LIVE data with settings:', settings);\n\n    const categories = settings?.categories || { movies: true, events: true, festivals: true, alerts: true, sports: true };\n    const locations = settings?.locations && settings.locations.length > 0 ? settings.locations : ['Chennai', 'India'];\n\n    // Extract keywords map for categorization\n    const keywordsMap = settings?.keywords || DEFAULT_SETTINGS.upAhead.keywords;\n\n    let allItems = [];\n    const urlsToFetch = [];\n\n    const addSearchUrl = (query) => {\n        const encoded = encodeURIComponent(query);\n        urlsToFetch.push({\n            url: `https://news.google.com/rss/search?q=${encoded}+when:7d&hl=en-IN&gl=IN&ceid=IN:en`,\n            type: 'search',\n            originalQuery: query\n        });\n    };\n\n    for (const [cat, isEnabled] of Object.entries(categories)) {\n        if (!isEnabled) continue;\n\n        if (STATIC_FEEDS[cat]) {\n            STATIC_FEEDS[cat].forEach(url => {\n                urlsToFetch.push({ url, type: 'static', category: cat });\n            });\n        }\n\n        const queries = CATEGORY_QUERIES[cat] || [];\n        queries.forEach(baseQuery => {\n            if (cat === 'events' || cat === 'alerts' || cat === 'movies') {\n                locations.forEach(loc => {\n                    if (loc.toLowerCase() === 'india' && (cat === 'alerts' || cat === 'events')) {\n                        return;\n                    }\n                    addSearchUrl(`${baseQuery} ${loc}`);\n                });\n            } else if (cat === 'shopping' || cat === 'airlines') {\n                 locations.forEach(loc => {\n                     addSearchUrl(`${baseQuery} ${loc}`);\n                 });\n            } else {\n                 addSearchUrl(`${baseQuery}`);\n            }\n        });\n    }\n\n    const uniqueUrls = [...new Map(urlsToFetch.map(item => [item.url, item])).values()];\n    console.log(`[UpAheadService] Prepared ${uniqueUrls.length} feeds to fetch.`);\n\n    // Start Live RSS Fetches\n    const fetchPromises = uniqueUrls.map(async (feedConfig) => {\n        try {\n            const { items } = await proxyManager.fetchViaProxy(feedConfig.url);\n            return items.map(item => normalizeUpAheadItem(item, feedConfig, keywordsMap));\n        } catch (error) {\n            console.warn(`[UpAheadService] Failed to fetch ${feedConfig.url}:`, error.message);\n            return [];\n        }\n    });\n\n    const results = await Promise.allSettled(fetchPromises);\n\n    for (let i = 0; i < results.length; i++) {\n        if (results[i].status === 'fulfilled') {\n            allItems.push(...results[i].value);\n        } else {\n            console.warn('[UpAheadService] A feed failed to load:', results[i].reason);\n        }\n    }\n\n    // Process RSS Data\n    const rssData = processUpAheadData(allItems, settings);\n\n    try {\n        for (const item of allItems) {\n            if (item.extractedDate) {\n                const dateResult = extractDate(\n                    `${item.title} ${item.description || ''}`,\n                    item.pubDate\n                );\n                if (dateResult) {\n                    const keys = expandDateKeys(dateResult);\n                    if (keys.length > 0) {\n                        plannerStorage.merge(keys, [{ id: item.id, title: item.title, category: item.category, link: item.link }]);\n                    }\n                }\n            }\n        }\n    } catch (e) {\n        console.warn('[UpAhead] Planner storage write failed', e);\n    }\n\n    const _dur = Date.now() - _t0;\n    const timelineCount = rssData?.timeline?.reduce((s, d) => s + (d.items?.length || 0), 0) || 0;\n    logStore.success('upAhead', `LIVE: ${timelineCount} items from ${uniqueUrls.length} feeds`, { durationMs: _dur });\n\n    return rssData;\n}\n\nfunction stripHtml(html) {\n    if (!html) return \"\";\n    let text = html.toString();\n    const entities = { '&nbsp;': ' ', '&amp;': '&', '&quot;': '\"', '&#39;': \"'\", '&lt;': '<', '&gt;': '>' };\n    text = text.replace(/&[a-z0-9#]+;/gi, (match) => entities[match] || match);\n    text = text.replace(/<script[^>]*>([\\S\\s]*?)<\\/script>/gmi, \"\");\n    text = text.replace(/<style[^>]*>([\\S\\s]*?)<\\/style>/gmi, \"\");\n    text = text.replace(/<\\/?[^>]+(>|$)/g, \"\");\n    return text.trim();\n}\n\nexport function normalizeUpAheadItem(item, config, keywordsMap = null) {\n    const title = stripHtml(item.title || '');\n    const rawDescription = item.description || '';\n    const description = stripHtml(rawDescription);\n    const fullText = `${title} ${description}`;\n\n    let pubDate = item.pubDate ? new Date(item.pubDate) : null;\n    if (pubDate && isNaN(pubDate.getTime())) {\n        pubDate = null;\n    }\n\n    // Determine Category using keywordsMap if available\n    let category = config.category;\n    if (!category || config.type === 'search') {\n        category = detectCategory(fullText, keywordsMap);\n    }\n\n    // 5-layer date extraction\n    let extractedDate = null;\n    const newDateResult = extractDate(fullText, pubDate);\n    if (newDateResult?.start) {\n        // Special logic for Shopping: Prefer End Date (Last Day) if available\n        if (category === 'shopping' && newDateResult.end) {\n            extractedDate = newDateResult.end;\n        } else {\n            extractedDate = newDateResult.start;\n        }\n    } else {\n        extractedDate = extractFutureDate(fullText, pubDate);\n    }\n\n    let subItems = [];\n    let isRoundup = false;\n    if (/ott|releases|week/i.test(title) && /\\d+ new/i.test(title)) {\n        isRoundup = true;\n    }\n\n    if (isRoundup && category === 'movies') {\n        subItems = parseRoundupContent(rawDescription, pubDate);\n    }\n\n    const dateStr = extractedDate ? extractedDate.toISOString().slice(0,10) : (pubDate ? pubDate.toISOString().slice(0,10) : 'nodate');\n    const canonicalId = generateCanonicalId(title, dateStr);\n\n    return {\n        id: item.guid || item.link || title,\n        canonicalId: canonicalId,\n        title: title,\n        link: item.link,\n        description: description,\n        pubDate: pubDate,\n        extractedDate: extractedDate,\n        category: category,\n        rawSource: config.originalQuery || 'feed',\n        isRoundup: isRoundup,\n        subItems: subItems\n    };\n}\n\nfunction parseRoundupContent(html, contextDate) {\n    const items = [];\n    const lines = html.split(/<br\\s*\\/?>|\\n|<\\/li>|<\\/p>|‚Ä¢/i);\n    const ottPlatforms = ['netflix', 'prime', 'prime video', 'hotstar', 'sony liv', 'zee5', 'jiocinema', 'aha', 'sunnxt', 'hulu', 'disney'];\n    const platformRegex = new RegExp(`\\\\b(${ottPlatforms.sort((a,b) => b.length - a.length).join('|')})\\\\b`, 'i');\n\n    lines.forEach(line => {\n        const cleanLine = stripHtml(line).trim();\n        if (cleanLine.length < 5) return;\n        const hasPlatform = platformRegex.test(cleanLine);\n        const date = extractFutureDate(cleanLine, contextDate);\n        if (hasPlatform || date) {\n            let title = cleanLine\n                .replace(/^\\d+\\.\\s*/, '')\n                .replace(/^[-\\u2013\\u2014]\\s*/, '')\n                .replace(/\\(.*\\)/g, '')\n                .trim();\n            if (title.length < 3) return;\n            const platformMatch = cleanLine.match(platformRegex);\n            const platform = platformMatch ? platformMatch[0] : 'OTT';\n            items.push({\n                title: title,\n                date: date,\n                originalText: cleanLine,\n                platform: platform.charAt(0).toUpperCase() + platform.slice(1).toLowerCase()\n            });\n        }\n    });\n    return items;\n}\n\n/**\n * Detect category based on keywords map from settings.\n */\nexport function detectCategory(text, keywordsMap = null) {\n    const t = text.toLowerCase();\n\n    // Use passed keywords map or fallback to Default\n    const k = keywordsMap || DEFAULT_SETTINGS.upAhead.keywords;\n\n    // Helper to check against array\n    const hasAny = (arr) => arr && arr.some(kw => matchesKeyword(t, kw));\n\n    // 1. Strict Exclusion\n    // Note: We don't have a \"general_negative\" in default, so relying on hardcoded for safety unless settings override\n    if (t.includes('arrest') || t.includes('held for') || t.includes('police') || t.includes('seized') || t.includes('murder') || t.includes('crime') || t.includes('jail') || t.includes('court') || t.includes('bail')) return 'general';\n    if (t.includes('clinic') && t.includes('unregistered')) return 'general';\n\n    // 2. Category Detection (Priority Order)\n    if (hasAny(k.weather_alerts)) return 'weather_alerts';\n    if (hasAny(k.alerts)) return 'alerts';\n\n    if (hasAny(k.movies)) {\n        // Strict Movie Filter\n        const negs = k.movies_negative || [];\n        if (negs.some(nw => matchesKeyword(t, nw))) return 'general';\n        return 'movies';\n    }\n\n    if (hasAny(k.sports)) {\n        const negs = k.sports_negative || [];\n        if (negs.some(nw => matchesKeyword(t, nw))) return 'general';\n        return 'sports';\n    }\n\n    if (hasAny(k.airlines)) return 'airlines';\n    if (hasAny(k.shopping)) return 'shopping';\n\n    if (hasAny(k.festivals)) return 'festivals';\n\n    if (hasAny(k.civic)) return 'civic';\n    if (hasAny(k.events)) return 'events';\n\n    return 'general';\n}\n\nexport function extractFutureDate(text, pubDate) {\n    // Legacy fallback wrapper around dateExtractor\n    const result = extractDate(text, pubDate);\n    return result?.start || null;\n}\n\nexport function processUpAheadData(rawItems, settings) {\n    const today = new Date();\n    today.setHours(0,0,0,0);\n\n    const timelineMap = new Map();\n    const sections = {\n        movies: [],\n        festivals: [],\n        alerts: [],\n        events: [],\n        sports: [],\n        shopping: [],\n        civic: [],\n        weather_alerts: [],\n        airlines: []\n    };\n\n    const seenIds = new Set();\n    const maxAgeHours = settings?.hideOlderThanHours || 336;\n    const maxAgeMs = maxAgeHours * 60 * 60 * 1000;\n\n    const CATEGORY_MAX_AGE_HOURS = {\n        weather_alerts: 6,\n        alerts: 12,\n        festivals: 336\n    };\n\n    const userKeywords = settings?.keywords || settings?.upAhead?.keywords || DEFAULT_SETTINGS.upAhead.keywords;\n\n    const getNegativesForCategory = (cat) => {\n        let globalNegs = (userKeywords.negative && userKeywords.negative.length > 0)\n            ? userKeywords.negative\n            : DEFAULT_SETTINGS.upAhead.keywords.negative;\n\n        const catKey = `${cat}_negative`;\n        const catNegs = (userKeywords[catKey] && userKeywords[catKey].length > 0)\n            ? userKeywords[catKey]\n            : (DEFAULT_SETTINGS.upAhead.keywords[catKey] || []);\n\n        return [...new Set([...globalNegs, ...catNegs])];\n    };\n\n    const signalWords = (settings?.signals || DEFAULT_SETTINGS.upAhead.signals);\n\n    const mergedPositives = {};\n    // Ensure all section keys exist in keywords map to avoid errors\n    const sectionKeys = ['movies', 'events', 'festivals', 'alerts', 'sports', 'shopping', 'civic', 'weather_alerts', 'airlines'];\n    sectionKeys.forEach(cat => {\n        mergedPositives[cat] = (userKeywords[cat] && userKeywords[cat].length > 0)\n            ? userKeywords[cat]\n            : DEFAULT_SETTINGS.upAhead.keywords[cat] || [];\n    });\n\n    const userLocations = (settings?.locations || settings?.upAhead?.locations || ['Chennai', 'Muscat', 'Trichy']).map(l => l.toLowerCase());\n\n    rawItems.forEach(item => {\n        if (seenIds.has(item.id)) return;\n        seenIds.add(item.id);\n\n        if (!item.pubDate || isNaN(item.pubDate.getTime())) {\n            return;\n        }\n\n        const ageMs = Date.now() - item.pubDate.getTime();\n        let effectiveMaxAgeMs = maxAgeMs;\n        if (CATEGORY_MAX_AGE_HOURS[item.category]) {\n            const catLimitMs = CATEGORY_MAX_AGE_HOURS[item.category] * 60 * 60 * 1000;\n            effectiveMaxAgeMs = Math.min(maxAgeMs, catLimitMs);\n        }\n\n        const isPlannerCategory = ['movies', 'events', 'sports', 'shopping', 'civic', 'festivals', 'airlines'].includes(item.category);\n        const hasFutureDate = item.extractedDate && item.extractedDate >= today;\n\n        if (!isPlannerCategory && !hasFutureDate && ageMs > effectiveMaxAgeMs) {\n            return;\n        }\n\n        const fullText = (item.title + \" \" + item.description).toLowerCase();\n\n        // Skip stale content based on text regex (e.g. \"2 years ago\")\n        const staleRegex = /(?:‚Ä¢|-|published)\\s*(\\d+)\\s*(mo|month|months|w|week|weeks|y|year|years)\\s*(?:ago)?/i;\n        const staleMatch = fullText.match(staleRegex);\n        if (staleMatch) {\n            const qty = parseInt(staleMatch[1]);\n            const unit = staleMatch[2].toLowerCase();\n            if (unit.startsWith('mo') || unit.startsWith('y')) return;\n            if (unit.startsWith('w') && qty >= 1) return;\n        }\n\n        const isRoundup = /ott|releases|week|weekend/i.test(fullText) && /\\d+ new/i.test(fullText);\n\n        // Ranking\n        let score = 0;\n        const rankingConfig = settings?.ranking?.[item.category] || settings?.upAhead?.ranking?.[item.category] || {};\n        const posMulti = rankingConfig.positiveMultiplier || 1.0;\n        const negMulti = rankingConfig.negativeMultiplier || 1.0;\n        const filterThreshold = rankingConfig.filterThreshold || 0;\n\n        const positives = mergedPositives[item.category] || [];\n        const negatives = getNegativesForCategory(item.category);\n\n        const posCount = positives.reduce((c, w) => matchesKeyword(fullText, w.toLowerCase()) ? c + 1 : c, 0);\n        const negCount = negatives.reduce((c, w) => matchesKeyword(fullText, w.toLowerCase()) ? c + 1 : c, 0);\n\n        score = (posCount * posMulti) - (negCount * negMulti);\n        const signalCount = signalWords.reduce((c, signal) => fullText.includes(signal) ? c + 1 : c, 0);\n        score += (signalCount * 0.5);\n\n        const isStrictCategory = ['movies', 'events', 'shopping', 'airlines', 'sports', 'festivals'].includes(item.category);\n        if (isStrictCategory && score < filterThreshold) {\n            return;\n        }\n\n        if (!isRoundup && negCount > 0 && score <= 0) {\n             return;\n        }\n\n        if (isPlannerCategory && !item.extractedDate && !item.isRoundup) {\n             if (posCount === 0 && signalCount === 0) {\n                 return;\n             }\n        }\n\n        if (item.category === 'alerts' || item.category === 'civic') {\n            const hasLocation = userLocations.some(loc => fullText.includes(loc));\n            if (!hasLocation) {\n                return;\n            }\n        }\n\n        item._forwardScore = score;\n\n        if (item.category && sections[item.category]) {\n            if ((item.category === 'movies' || item.category === 'events' || item.category === 'festivals') && !item.extractedDate && !item.isRoundup) {\n                return;\n            }\n\n            if (isPlannerCategory && !item.extractedDate && !item.isRoundup) {\n                if (score <= 0) return;\n            }\n\n            if (item.category === 'festivals' && item.extractedDate) {\n                const diffTime = item.extractedDate.getTime() - today.getTime();\n                const diffDays = diffTime / (1000 * 3600 * 24);\n                if (diffDays < -3) return;\n            } else if (isPlannerCategory && item.extractedDate) {\n                 if (item.extractedDate < today) return;\n            }\n\n            let fallbackDate = null;\n            if (!item.extractedDate && ['shopping', 'alerts', 'weather_alerts', 'civic'].includes(item.category)) {\n                 fallbackDate = item.pubDate ? item.pubDate.toDateString() : null;\n            }\n\n            const displayItem = {\n                title: item.title,\n                link: item.link,\n                releaseDate: item.extractedDate ? item.extractedDate.toDateString() : fallbackDate,\n                date: item.extractedDate ? item.extractedDate.toDateString() : fallbackDate,\n                text: item.title,\n                severity: 'medium',\n                language: 'Unknown',\n                isRoundup: item.isRoundup,\n                subItemsCount: item.subItems ? item.subItems.length : 0\n            };\n            sections[item.category].push(displayItem);\n        }\n\n        let targetDate = item.extractedDate;\n        if (!targetDate && (item.category === 'alerts' || item.category === 'weather_alerts')) {\n             const limit = item.category === 'weather_alerts' ? 12 : 24;\n             if (item.pubDate && (Date.now() - item.pubDate.getTime() < limit * 60 * 60 * 1000)) {\n                 targetDate = today;\n             } else {\n                 return;\n             }\n        }\n        if (!targetDate && item.isRoundup) {\n            targetDate = today;\n        }\n\n        if (!targetDate && score > 0 && isPlannerCategory) {\n            if (['shopping', 'airlines', 'alerts', 'weather_alerts', 'civic'].includes(item.category)) {\n                if (item.pubDate && (Date.now() - item.pubDate.getTime() < 48 * 60 * 60 * 1000)) {\n                    targetDate = today;\n                }\n            }\n        }\n\n        if (targetDate && targetDate >= today) {\n            const dateKey = targetDate.toISOString().split('T')[0];\n            if (!timelineMap.has(dateKey)) {\n                timelineMap.set(dateKey, {\n                    date: dateKey,\n                    dayLabel: getDayLabel(targetDate),\n                    items: []\n                });\n            }\n            const timelineItem = {\n                id: item.id,\n                type: getItemType(item.category),\n                title: item.title,\n                subtitle: item.isRoundup ? `${item.subItems?.length || 'Multiple'} ITEMS` : item.category.toUpperCase(),\n                description: item.description,\n                tags: [item.category],\n                link: item.link,\n                isRoundup: item.isRoundup,\n                subItems: item.subItems,\n                _forwardScore: item._forwardScore || 0\n            };\n            timelineMap.get(dateKey).items.push(timelineItem);\n        }\n    });\n\n    const sortedTimeline = Array.from(timelineMap.values()).sort((a, b) => a.date.localeCompare(b.date));\n    sortedTimeline.forEach(day => {\n        day.items.sort((a, b) => (b._forwardScore || 0) - (a._forwardScore || 0));\n        day.items.forEach(item => delete item._forwardScore);\n    });\n\n    Object.keys(sections).forEach(k => {\n        sections[k].sort((a, b) => {\n            if (a.date && b.date) {\n                return new Date(a.date) - new Date(b.date);\n            }\n            return 0;\n        });\n        sections[k] = sections[k].slice(0, 10);\n    });\n\n    // Pass blacklist (empty here, handled by UI generally, but we generate base plan)\n    const blacklist = plannerStorage.getBlacklist ? plannerStorage.getBlacklist() : new Set();\n    const weekly_plan = generateWeeklyPlan(sortedTimeline, blacklist);\n\n    return {\n        timeline: sortedTimeline,\n        sections: sections,\n        weekly_plan: weekly_plan,\n        lastUpdated: new Date().toISOString()\n    };\n}\n\nfunction getDayLabel(date) {\n    const today = new Date();\n    today.setHours(0,0,0,0);\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n\n    const d = new Date(date);\n    d.setHours(0,0,0,0);\n    if (d.getTime() === today.getTime()) return \"Today\";\n    if (d.getTime() === tomorrow.getTime()) return \"Tomorrow\";\n    return d.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' });\n}\n\nfunction getItemType(category) {\n    const map = {\n        movies: 'movie',\n        events: 'event',\n        festivals: 'festival',\n        alerts: 'alert',\n        sports: 'sport',\n        shopping: 'shopping',\n        civic: 'civic',\n        weather_alerts: 'weather_alert',\n        airlines: 'airline'\n    };\n    return map[category] || 'event';\n}\n\nfunction generateWeeklyPlan(timeline, blacklist = new Set()) {\n    const plan = [];\n    const today = new Date();\n\n    const getOrdinal = (n) => {\n        const s = [\"th\", \"st\", \"nd\", \"rd\"];\n        const v = n % 100;\n        return n + (s[(v - 20) % 10] || s[v] || s[0]);\n    };\n\n    // Generate 7 days\n    for (let i = 0; i < 7; i++) {\n        const d = new Date(today);\n        d.setDate(today.getDate() + i);\n        const dateStr = d.toISOString().split('T')[0];\n\n        const dayName = d.toLocaleDateString('en-US', { weekday: 'long' });\n        const monthShort = d.toLocaleDateString('en-US', { month: 'short' });\n        const dayNum = d.getDate();\n        const dateLabel = `${getOrdinal(dayNum)} ${monthShort}`;\n\n        const timelineDay = timeline.find(t => t.date === dateStr);\n        let items = [];\n\n        if (timelineDay && timelineDay.items.length > 0) {\n            // Logic:\n            // 1. Exclude Festivals (separate view usually)\n            // 2. Exclude Blacklisted items\n            // 3. Include Shopping/Airlines (Offers) - Assuming date logic (Last Day) handled in extraction\n\n            const filteredItems = timelineDay.items.filter(item => {\n                if (item.type === 'festival') return false;\n                if (blacklist.has(item.id)) return false;\n                return true;\n            });\n\n            items = filteredItems.slice(0, 10).map(item => ({\n                id: item.id,\n                title: item.title,\n                type: item.type,\n                icon: getCategoryIcon(item.type),\n                link: item.link,\n                description: item.description,\n                isOffer: item.type === 'shopping' || item.type === 'airline'\n            }));\n        }\n\n        plan.push({\n            day: dayName,\n            date: dateLabel,\n            items: items\n        });\n    }\n\n    return plan;\n}\n\nfunction getCategoryIcon(type) {\n    const icons = {\n        movie: 'üé¨',\n        event: 'üé≠',\n        festival: 'üéä',\n        alert: '‚ö†Ô∏è',\n        sport: '‚öΩ',\n        shopping: 'üõí',\n        civic: 'üèõÔ∏è',\n        entertainment: 'üé∂',\n        weather_alert: 'üå™Ô∏è',\n        airline: '‚úàÔ∏è',\n        general: 'üìÖ'\n    };\n    return icons[type] || 'üìÖ';\n}\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { Link } from 'react-router-dom';\nimport Header from '../components/Header';\nimport { useWatchlist } from '../hooks/useWatchlist';\nimport { downloadCalendarEvent } from '../utils/calendar';\nimport {\n    fetchStaticUpAheadData,\n    fetchLiveUpAheadData,\n    mergeUpAheadData,\n    loadFromCache,\n    saveToCache\n} from '../services/upAheadService';\nimport plannerStorage from '../utils/plannerStorage';\nimport { useSettings } from '../context/SettingsContext';\nimport './UpAhead.css';\n\nfunction UpAheadPage() {\n    const { settings } = useSettings();\n\n    // Data state\n    const [data, setData] = useState(null);\n\n    // Loading state\n    const [loading, setLoading] = useState(true);\n    const [isRefreshing, setIsRefreshing] = useState(false);\n    const [loadingPhase, setLoadingPhase] = useState(0); // 0: Init, 1: Local, 2: Static, 3: Live\n\n    // View state\n    const [view, setView] = useState('plan');\n\n    // Blacklist state\n    const [, setBlacklist] = useState(plannerStorage.getBlacklist ? plannerStorage.getBlacklist() : new Set());\n\n    const { toggleWatchlist, isWatched } = useWatchlist();\n\n    const loadData = useCallback(async (forceRefresh = false) => {\n        // If force refresh, reset phases slightly or just ensure we do fetch live\n        if (forceRefresh) {\n            setIsRefreshing(true);\n            setLoadingPhase(1); // Reset to indicate working\n        } else {\n             setLoading(true);\n             setLoadingPhase(0);\n        }\n\n        // PHASE 1: Local Cache (Immediate)\n        // Only load cache if we are starting fresh (not a manual refresh)\n        if (!forceRefresh) {\n            const cached = loadFromCache();\n            if (cached) {\n                setData(cached);\n                setLoading(false); // Show content immediately\n                setLoadingPhase(1);\n            }\n        }\n\n        // PHASE 2: Static Data (Fast)\n        // Always fetch static to get base events\n        try {\n            const staticData = await fetchStaticUpAheadData();\n            if (staticData) {\n                setData(prev => {\n                    const merged = mergeUpAheadData(prev, staticData);\n                    return merged;\n                });\n                if (!forceRefresh) setLoadingPhase(2);\n                setLoading(false);\n            }\n        } catch (e) {\n            console.warn(\"Static fetch failed\", e);\n        }\n\n        // PHASE 3: Live Data (Background)\n        // Use settings to fetch live\n        setIsRefreshing(true);\n        try {\n            const upAheadSettings = settings.upAhead || {\n                categories: { movies: true, events: true, festivals: true, alerts: true, sports: true, shopping: true, civic: true, weather_alerts: true, airlines: true },\n                locations: ['Chennai']\n            };\n\n            const liveData = await fetchLiveUpAheadData(upAheadSettings);\n\n            setData(prev => {\n                const merged = mergeUpAheadData(prev, liveData);\n                // Save complete dataset to cache\n                saveToCache(merged);\n                return merged;\n            });\n            setLoadingPhase(3);\n        } catch (err) {\n            console.error(\"Failed to load Live Up Ahead data\", err);\n        } finally {\n            setIsRefreshing(false);\n            setLoading(false);\n        }\n    }, [settings.upAhead]);\n\n    // Initial Load\n    useEffect(() => {\n        loadData(false);\n    }, [loadData]);\n\n    // Handle Blacklist removal\n    const handleRemoveFromPlan = (id) => {\n        if (!id) return;\n        if (plannerStorage.addToBlacklist) {\n            plannerStorage.addToBlacklist(id);\n            setBlacklist(plannerStorage.getBlacklist());\n            // Re-merge/process logic is implied by state update usually,\n            // but since we pre-calculate weekly_plan in service, we might need to soft-refresh.\n            // For now, we rely on the next render or manual refresh to clean up completely,\n            // but we can filter `data` locally for immediate UI feedback if needed.\n            // Simplified: Force a re-merge of current data?\n            // Actually, `mergeUpAheadData` calls `generateWeeklyPlan` which reads blacklist (if passed).\n            // But we can't easily trigger just that.\n            // Let's just reload data (cached/static will be fast).\n            loadData(false);\n        }\n    };\n\n    const handleAddToPlan = (item, dateStr) => {\n        plannerStorage.addItem(dateStr, {\n            id: item.id,\n            title: item.title,\n            category: item.tags?.[0] || 'event',\n            link: item.link,\n            description: item.description\n        });\n        alert(\"Added to Plan!\");\n    };\n\n    // --- RENDER HELPERS ---\n    const formatConciseDate = (dateStr) => {\n        if (!dateStr) return 'Coming Soon';\n        const d = new Date(dateStr);\n        if (isNaN(d.getTime())) return dateStr;\n        const dayName = d.toLocaleDateString('en-US', { weekday: 'short' });\n        const dayNum = d.getDate().toString().padStart(2, '0');\n        const month = d.toLocaleDateString('en-US', { month: 'short' });\n        return `${dayName}, ${dayNum} ${month}`;\n    };\n\n    const CompactEventList = ({ items, colorClass, emptyMessage, isOffer = false }) => {\n        if (!items || items.length === 0) return <div className=\"empty-state\"><p>{emptyMessage}</p></div>;\n        return (\n            <div className=\"ua-wk-card\" style={{border: 'none', background: 'transparent', padding: 0}}>\n                <ul className=\"ua-wk-list\">\n                    {items.map((item, i) => {\n                        const dateText = formatConciseDate(item.date || item.releaseDate);\n                        return (\n                            <li key={i} className=\"ua-wk-item\" style={{display:'flex', justifyContent:'space-between', alignItems:'center', gap:'10px', background: 'var(--bg-secondary)', padding: '12px', borderRadius: '12px', marginBottom: '8px'}}>\n                                <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\" style={{textDecoration:'none', color:'inherit', flex:1, overflow:'hidden', display:'flex', alignItems:'center', gap: '8px'}}>\n                                    {isOffer && <span style={{fontSize:'1.2rem'}}>üè∑Ô∏è</span>}\n                                    <span className=\"ua-wk-text\" style={{whiteSpace:'nowrap', overflow:'hidden', textOverflow:'ellipsis', fontSize: '0.95rem', fontWeight: 500}}>{item.title}</span>\n                                </a>\n                                <span className={`ua-wk-date ${colorClass}`} style={{whiteSpace:'nowrap', flexShrink:0, fontSize: '0.8rem', fontWeight: 600}}>{dateText}</span>\n                            </li>\n                        );\n                    })}\n                </ul>\n            </div>\n        );\n    };\n\n    if (loading && !data) {\n        return (\n            <div className=\"page-container\">\n                <Header title=\"Up Ahead\" icon=\"üóìÔ∏è\" loadingPhase={loadingPhase} />\n                <div className=\"loading\">\n                    <div className=\"loading__spinner\"></div>\n                    <p>Scanning horizon...</p>\n                </div>\n            </div>\n        );\n    }\n\n    if (!data || !data.timeline || data.timeline.length === 0) {\n         return (\n            <div className=\"page-container\">\n                <Header title=\"Up Ahead\" icon=\"üóìÔ∏è\" loadingPhase={loadingPhase} />\n                <div className=\"empty-state\">\n                    <span style={{ fontSize: '3rem' }}>üî≠</span>\n                    <h3>Nothing on the radar</h3>\n                    <p>No upcoming events found.</p>\n                    <button onClick={() => loadData(true)} className=\"btn btn--primary\" style={{ marginTop: '1rem' }}>Retry Scan</button>\n                    <div style={{ marginTop: '0.75rem' }}><small>Try adding more locations or categories in <Link to=\"/settings\" style={{ color: 'var(--accent-primary)' }}>Settings</Link>.</small></div>\n                </div>\n            </div>\n        );\n    }\n\n    const weatherAlerts = data.sections?.weather_alerts || [];\n    const generalAlerts = data.sections?.alerts || [];\n    const civicAlerts = data.sections?.civic || [];\n    const combinedAlerts = [...weatherAlerts, ...generalAlerts, ...civicAlerts];\n\n    const highPriorityAlert = weatherAlerts[0] || generalAlerts[0] || null;\n    const alertIcon = weatherAlerts.length > 0 ? 'üå™Ô∏è' : '‚ö†Ô∏è';\n    const alertTitle = weatherAlerts.length > 0 ? 'Weather Warning' : 'Worth Knowing';\n\n    return (\n        <div className=\"page-container up-ahead-page\">\n            <Header\n                title=\"Up Ahead\"\n                icon=\"üóìÔ∏è\"\n                loadingPhase={loadingPhase}\n                rightElement={isRefreshing ? <div className=\"scanning-indicator\" style={{fontSize:'0.7rem', color:'var(--accent-primary)'}}>Scanning...</div> : null}\n            />\n\n            <div style={{\n                textAlign: 'center',\n                fontSize: '0.7rem',\n                color: 'var(--text-muted)',\n                padding: '6px',\n                background: 'var(--bg-secondary)',\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                gap: '8px'\n            }}>\n                {isRefreshing ? (\n                    <>\n                        <div className=\"loading__spinner\" style={{width:'12px', height:'12px', borderWidth:'2px'}}></div>\n                        <span>Scanning horizon...</span>\n                    </>\n                ) : (\n                    <>\n                        <span>Live Feed ‚Ä¢ {settings.upAhead?.locations?.join(', ') || 'All Locations'}</span>\n                        <button onClick={() => loadData(true)} style={{background:'none', border:'none', cursor:'pointer', fontSize:'0.8rem'}}>üîÑ</button>\n                    </>\n                )}\n            </div>\n\n            {highPriorityAlert && (\n                <div className={`ua-alert-banner ${weatherAlerts.length > 0 ? 'weather-alert' : ''}`}>\n                    <span className=\"ua-alert-icon\">{alertIcon}</span>\n                    <div className=\"ua-alert-content\">\n                        <h4>{alertTitle}</h4>\n                        <p>{highPriorityAlert.text}</p>\n                    </div>\n                </div>\n            )}\n\n            <div className=\"ua-view-toggle scrollable-tabs\">\n                <button className={`ua-toggle-btn ${view === 'plan' ? 'active' : ''}`} onClick={() => setView('plan')}>Plan My Week</button>\n                <button className={`ua-toggle-btn ${view === 'offers' ? 'active' : ''}`} onClick={() => setView('offers')}>Offers</button>\n                <button className={`ua-toggle-btn ${view === 'movies' ? 'active' : ''}`} onClick={() => setView('movies')}>Releasing Soon</button>\n                <button className={`ua-toggle-btn ${view === 'events' ? 'active' : ''}`} onClick={() => setView('events')}>Upcoming Events</button>\n                <button className={`ua-toggle-btn ${view === 'alerts' ? 'active' : ''}`} onClick={() => setView('alerts')}>Alerts</button>\n                <button className={`ua-toggle-btn ${view === 'festivals' ? 'active' : ''}`} onClick={() => setView('festivals')}>Festivals</button>\n                <button className={`ua-toggle-btn ${view === 'feed' ? 'active' : ''}`} onClick={() => setView('feed')}>Timeline</button>\n            </div>\n\n            {view === 'plan' && (\n                <div className=\"ua-weekly-plan\">\n                     {(data.weekly_plan && Array.isArray(data.weekly_plan)) ? data.weekly_plan.map((dayData, dIdx) => (\n                         <div key={dIdx} className=\"ua-plan-day-row\">\n                             <div className=\"ua-plan-ribbon\">\n                                 <div style={{fontSize: '0.95rem', fontWeight: 800, whiteSpace: 'nowrap'}}>\n                                     {dayData.day} <span style={{opacity: 0.8, fontWeight: 400}}>{dayData.date}</span>\n                                 </div>\n                             </div>\n                             <div className=\"ua-plan-day-content\">\n                                 {dayData.items && dayData.items.length > 0 ? (\n                                     dayData.items.map((item, idx) => (\n                                         <div key={idx} className=\"ua-plan-event-item\">\n                                              <button className=\"ua-plan-delete-btn\" onClick={(e) => { e.preventDefault(); handleRemoveFromPlan(item.id); }} aria-label=\"Remove event\" style={{background:'none', border:'none', cursor:'pointer', color:'var(--text-muted)', fontSize:'0.9rem', padding: '0 8px 0 0'}}>‚úï</button>\n                                             <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\" style={{flex:1, display:'flex', alignItems:'center', gap:'10px', textDecoration:'none', color:'inherit'}}>\n                                                 <span className=\"ua-event-icon\">{item.icon}</span>\n                                                 <div style={{display:'flex', flexDirection:'column'}}>\n                                                     <span className=\"ua-event-title\">{item.title}</span>\n                                                     {item.isOffer && <span className=\"ua-offer-badge\">üõí Ends Today</span>}\n                                                 </div>\n                                             </a>\n                                             <div style={{display:'flex', gap:'8px'}}>\n                                                 <button className=\"ua-plan-action-btn\" onClick={(e) => { e.preventDefault(); downloadCalendarEvent(item.title, item.description || item.title); }} title=\"Add to Calendar\" style={{background:'none', border:'none', cursor:'pointer', fontSize:'1.1rem'}}>üìÖ</button>\n                                             </div>\n                                         </div>\n                                     ))\n                                 ) : <span className=\"ua-plan-empty\" style={{padding: '10px', color: 'var(--text-muted)', fontSize: '0.9rem'}}>-</span>}\n                             </div>\n                         </div>\n                     )) : <div style={{textAlign:'center', padding:'20px'}}>Data unavailable.</div>}\n                </div>\n            )}\n\n            {view === 'movies' && <div className=\"ua-tab-view\"><CompactEventList items={data.sections?.movies} colorClass=\"text-accent-info\" emptyMessage=\"No upcoming movie releases found.\" /></div>}\n            {view === 'offers' && <div className=\"ua-tab-view\"><CompactEventList items={[...(data.sections?.shopping || []), ...(data.sections?.airlines || [])]} colorClass=\"text-accent-success\" emptyMessage=\"No offers found.\" isOffer={true} /><div style={{textAlign:'center', marginTop:'10px', fontSize:'0.8rem', color:'var(--text-muted)'}}>Including Airline Offers</div></div>}\n            {view === 'events' && <div className=\"ua-tab-view\"><CompactEventList items={[...(data.sections?.events || []), ...(data.sections?.sports || [])]} colorClass=\"text-accent-primary\" emptyMessage=\"No upcoming events found.\" /></div>}\n            {view === 'alerts' && <div className=\"ua-tab-view\"><CompactEventList items={combinedAlerts} colorClass=\"text-accent-error\" emptyMessage=\"No alerts found.\" /></div>}\n            {view === 'festivals' && <div className=\"ua-tab-view\"><CompactEventList items={data.sections?.festivals} colorClass=\"text-accent-warning\" emptyMessage=\"No festivals found.\" /></div>}\n\n            {view === 'feed' && (\n                <div className=\"ua-timeline\">\n                    {data.timeline.map((day) => (\n                        <div key={day.date} className=\"ua-day-section\">\n                            <div className=\"ua-day-header\">\n                                <div className=\"ua-day-label\">{day.dayLabel}</div>\n                                <div className=\"ua-date-sub\">{day.date}</div>\n                            </div>\n                            {day.items?.map(item => (\n                                <div key={item.id} className=\"ua-media-card\">\n                                    <div className=\"ua-media-content\">\n                                        <div className=\"ua-media-header\">\n                                            <span className={`ua-badge type-${item.type}`}>{item.type.toUpperCase()}</span>\n                                            <button className={`ua-watch-btn ${isWatched(item.id) ? 'active' : ''}`} onClick={() => toggleWatchlist(item.id)}>{isWatched(item.id) ? '‚òÖ' : '‚òÜ'}</button>\n                                        </div>\n                                        <h3 className=\"ua-media-title\">{item.title}</h3>\n                                        <p className=\"ua-media-desc\">{item.description ? (item.description.length > 100 ? item.description.substring(0, 100) + '...' : item.description) : ''}</p>\n                                        <div className=\"ua-media-footer\">\n                                            {item.link && <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\" className=\"ua-source-link\">Read Source ‚Üó</a>}\n                                            <button className=\"ua-cal-btn\" onClick={() => handleAddToPlan(item, day.date)} title=\"Add to Plan My Week\">üìå Plan</button>\n                                        </div>\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    ))}\n                </div>\n            )}\n        </div>\n    );\n}\n\nexport default UpAheadPage;\n"],"names":["useWatchlist","storageKey","watchlist","setWatchlist","useState","id","newWatchlist","itemId","downloadCalendarEvent","title","description","now","start","end","eventText","blob","url","a","MONTHS","DAYS","MONTH_NAMES_REGEX_STR","m","ISO_REGEX","DMY_REGEX","NAMED_REGEX_1","NAMED_REGEX_2","RANGE_REGEX_1","RANGE_REGEX_2","RANGE_REGEX_3","RELATIVE_NEXT_N_REGEX","DEADLINE_REGEX","monthNum","str","inferYear","month","day","ref","d","extractISO","text","iso","dmy","extractNamed","m1","mo","yr","m2","extractRange","m3","extractRelative","lower","nextN","n","unit","i","diff","sat","sun","extractDeadline","extractDate","pubDate","expandDateKeys","dateResult","maxDays","keys","PLANNER_KEY","BLACKLIST_KEY","API_BASE","plannerStorage","blResponse","remoteBlacklist","localBlacklist","merged","planResponse","remotePlan","localPlanRaw","mergedPlan","e","days","data","parsed","today","date","b","items","item","dates","newItems","changed","existingIds","planData","list","CACHE_KEY","loadFromCache","cached","saveToCache","_wbCache","matchesWord","word","re","escaped","hash","value","h","generateCanonicalId","dateStr","slug","matchesKeyword","keyword","lowerText","lowerKeyword","CATEGORY_QUERIES","STATIC_FEEDS","fetchStaticUpAheadData","response","mergeUpAheadData","baseData","newData","timelineMap","existingDay","key","existing","existingTitles","combined","generateWeeklyPlan","fetchLiveUpAheadData","settings","_t0","categories","locations","keywordsMap","DEFAULT_SETTINGS","allItems","urlsToFetch","addSearchUrl","query","encoded","cat","isEnabled","baseQuery","loc","uniqueUrls","fetchPromises","feedConfig","proxyManager","normalizeUpAheadItem","error","results","rssData","processUpAheadData","_dur","timelineCount","s","logStore","stripHtml","html","entities","match","config","rawDescription","fullText","category","detectCategory","extractedDate","newDateResult","extractFutureDate","subItems","isRoundup","parseRoundupContent","canonicalId","contextDate","lines","ottPlatforms","platformRegex","line","cleanLine","hasPlatform","platformMatch","platform","k","hasAny","arr","kw","nw","rawItems","sections","seenIds","maxAgeMs","CATEGORY_MAX_AGE_HOURS","userKeywords","getNegativesForCategory","globalNegs","catKey","catNegs","signalWords","mergedPositives","userLocations","l","ageMs","effectiveMaxAgeMs","catLimitMs","isPlannerCategory","hasFutureDate","staleRegex","staleMatch","qty","score","rankingConfig","posMulti","negMulti","filterThreshold","positives","negatives","posCount","c","w","negCount","signalCount","signal","fallbackDate","displayItem","targetDate","limit","dateKey","getDayLabel","timelineItem","getItemType","sortedTimeline","blacklist","weekly_plan","tomorrow","timeline","plan","getOrdinal","v","dayName","monthShort","dayNum","dateLabel","timelineDay","t","getCategoryIcon","type","UpAheadPage","useSettings","setData","loading","setLoading","isRefreshing","setIsRefreshing","loadingPhase","setLoadingPhase","view","setView","setBlacklist","toggleWatchlist","isWatched","loadData","useCallback","forceRefresh","staticData","prev","upAheadSettings","liveData","err","useEffect","handleRemoveFromPlan","handleAddToPlan","formatConciseDate","CompactEventList","colorClass","emptyMessage","isOffer","jsx","dateText","jsxs","Header","Link","weatherAlerts","generalAlerts","civicAlerts","combinedAlerts","highPriorityAlert","alertIcon","alertTitle","Fragment","dayData","dIdx","idx"],"mappings":"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"}