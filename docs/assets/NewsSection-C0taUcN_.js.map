{"version":3,"file":"NewsSection-C0taUcN_.js","sources":["../../src/components/NewsSection.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { getCredibilityStars } from '../data/sourceMetrics';\nimport { addReadArticle, getSettings } from '../utils/storage';\nimport { useNews } from '../context/NewsContext';\n\n/**\n * News Section Component\n * Displays news items for a specific region (World/India/Chennai/Trichy/Local/Entertainment)\n * Features:\n * - Clickable headlines open story URL\n * - Critics/public view shown where applicable\n * - Source count displayed\n * - Collapsible header\n */\nfunction NewsSection({\n    id,\n    title,\n    icon,\n    colorClass,\n    news = [],\n    maxDisplay = 3,\n    showExpand = true,\n    error = null,\n    extraContent = null,\n    onArticleClick = null,\n    showCritics = true\n}) {\n    const [expanded, setExpanded] = useState(false);\n    const [isCollapsed, setIsCollapsed] = useState(false);\n    const { auditResults } = useNews();\n\n    // Get trending threshold from settings (default 12)\n    const settings = getSettings();\n    const trendingThreshold = settings.rankingWeights?.trending?.threshold || 12;\n\n    const displayCount = expanded ? news.length : Math.min(maxDisplay, news.length);\n    const displayNews = news.slice(0, displayCount);\n    const hasMore = news.length > maxDisplay;\n\n    // --- Section Health Badges ---\n    const health = news.health || { status: 'ok' };\n    const isSingleSource = news.isSingleSource;\n\n    const getImpactStars = (score) => {\n        if (!score && score !== 0) return '';\n        if (score > 15) return '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê';\n        if (score > 10) return '‚≠ê‚≠ê‚≠ê‚≠ê';\n        if (score > 6) return '‚≠ê‚≠ê‚≠ê';\n        if (score > 3) return '‚≠ê‚≠ê';\n        return '‚≠ê';\n    };\n\n    const getConfidenceClass = (confidence) => {\n        switch (confidence?.toUpperCase()) {\n            case 'HIGH': return 'news-item__confidence--high';\n            case 'MEDIUM': return 'news-item__confidence--medium';\n            case 'LOW': return 'news-item__confidence--low';\n            default: return '';\n        }\n    };\n\n    const getTimeAgo = (timestamp) => {\n        if (!timestamp) return '';\n        const seconds = Math.floor((Date.now() - timestamp) / 1000);\n        let interval = seconds / 31536000;\n        if (interval > 1) return Math.floor(interval) + \"y ago\";\n        interval = seconds / 2592000;\n        if (interval > 1) return Math.floor(interval) + \"mo ago\";\n        interval = seconds / 86400;\n        if (interval > 1) return Math.floor(interval) + \"d ago\";\n        interval = seconds / 3600;\n        if (interval > 1) return Math.floor(interval) + \"h ago\";\n        interval = seconds / 60;\n        if (interval > 1) return Math.floor(interval) + \"m ago\";\n        return \"Just now\";\n    };\n\n    const handleStoryClick = (item) => {\n        // Track history\n        addReadArticle(item);\n\n        // External handler\n        if (onArticleClick) {\n            onArticleClick(item);\n        }\n\n        if (item.url) {\n            window.open(item.url, '_blank', 'noopener,noreferrer');\n        }\n    };\n\n    const renderContent = () => {\n        if (error) {\n            return (\n                <div className=\"empty-state\" style={{ borderColor: 'rgba(255, 87, 87, 0.3)' }}>\n                    <div className=\"empty-state__icon\">‚ùå</div>\n                    <p style={{ color: '#ff5757' }}>{error}</p>\n                </div>\n            );\n        }\n\n        if (news.length === 0) {\n            return (\n                <div className=\"empty-state\">\n                    <div className=\"empty-state__icon\">üì≠</div>\n                    <p>No news available for this section</p>\n                </div>\n            );\n        }\n\n        return (\n            <>\n                {extraContent}\n                <div className=\"news-list\">\n                    {displayNews.map((item, idx) => (\n                        <article\n                            key={item.id || idx}\n                            className=\"news-item\"\n                            onClick={() => handleStoryClick(item)}\n                            style={{ cursor: item.url ? 'pointer' : 'default' }}\n                        >\n                            {/* Badges Row */}\n                            <div className=\"news-item__badges\" style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px', fontSize: '0.85rem' }}>\n                                {getImpactStars(item.impactScore) && (\n                                    <span title={`Impact Score: ${item.impactScore?.toFixed(1)}`}>{getImpactStars(item.impactScore)}</span>\n                                )}\n                                {item.isBreaking && <span title=\"Breaking News\">‚ö°</span>}\n                                {(!item.isBreaking && item.impactScore > trendingThreshold) && <span title=\"Trending\">üî•</span>}\n\n                                {/* Audit Badges */}\n                                {auditResults[item.id] && (\n                                    <span className=\"audit-badges\" style={{ display: 'flex', gap: '4px' }}>\n                                        {auditResults[item.id].consensus?.badge && <span title={`Corroborated by ${auditResults[item.id].consensus.count} sources`}>{auditResults[item.id].consensus.badge}</span>}\n                                        {auditResults[item.id].persistenceBadge && <span title=\"Persistence\">{auditResults[item.id].persistenceBadge}</span>}\n                                        {auditResults[item.id].relevance?.badge && <span title=\"Relevance\">{auditResults[item.id].relevance.badge}</span>}\n                                        {auditResults[item.id].anomaly?.badge && <span title={`Anomaly: ${auditResults[item.id].anomaly.type}`}>{auditResults[item.id].anomaly.badge}</span>}\n                                        {auditResults[item.id].breakingVerified && <span title=\"Verified\">{auditResults[item.id].breakingVerified}</span>}\n                                    </span>\n                                )}\n                            </div>\n\n                            <h3 className=\"news-item__headline\">\n                                ‚Ä¢ {item.headline}\n                                {item.url && (\n                                    <span style={{\n                                        fontSize: '0.7rem',\n                                        marginLeft: '8px',\n                                        color: 'var(--accent-secondary)'\n                                    }}>‚Üó</span>\n                                )}\n                            </h3>\n                            {item.summary && (\n                                <p className=\"news-item__summary\">\n                                    {item.summary}\n                                </p>\n                            )}\n                            {showCritics && item.criticsView && (\n                                <div className=\"news-item__critics\">\n                                    <span>üí¨</span>\n                                    <div>\n                                        <strong style={{ color: 'var(--accent-secondary)', display: 'block', marginBottom: '2px' }}>Critics Take:</strong>\n                                        {item.criticsView}\n                                    </div>\n                                </div>\n                            )}\n                            <div className=\"news-item__meta\">\n                                {item.sentiment && (\n                                    <span\n                                        className={`sentiment-badge sentiment--${item.sentiment.label}`}\n                                        title={`Sentiment: ${item.sentiment.label}`}\n                                    >\n                                        {item.sentiment.label === 'positive' ? 'üü¢' :\n                                            item.sentiment.label === 'negative' ? 'üî¥' : '‚ö™'}\n                                    </span>\n                                )}\n                                <span className=\"news-item__source\">{item.source}</span>\n                                {item.sourceCount > 1 && (\n                                    <span\n                                        className=\"news-item__consensus\"\n                                        title={`Reported by ${item.sourceCount} sources`}\n                                    >\n                                        üîî {item.sourceCount} sources\n                                    </span>\n                                )}\n                                <span>|</span>\n                                <span>{getTimeAgo(item.publishedAt) || item.time}</span>\n                                {item.sourceCount && (\n                                    <>\n                                        <span>|</span>\n                                        <span>#{item.sourceCount} Sources</span>\n                                    </>\n                                )}\n                                <span>|</span>\n                                <span className={`news-item__confidence ${getConfidenceClass(item.confidence)}`}>\n                                    {item.confidence}\n                                </span>\n                            </div>\n                        </article>\n                    ))}\n                </div>\n\n                {showExpand && hasMore && (\n                    <div\n                        className=\"news-more\"\n                        onClick={() => setExpanded(!expanded)}\n                    >\n                        <span style={{ fontSize: '1.2rem' }}>{expanded ? '‚ñ≤' : '‚ñº'}</span>\n                        <span>{expanded ? 'Collapse' : `See ${news.length - maxDisplay} more stories`}</span>\n                    </div>\n                )}\n            </>\n        );\n    };\n\n    return (\n        <section className=\"news-section\" id={id}>\n            <h2\n                className={`news-section__title ${colorClass}`}\n                onClick={() => setIsCollapsed(!isCollapsed)}\n                style={{ cursor: 'pointer' }}\n                title={`Tap to fold/unfold. Health: ${health.status.toUpperCase()}`}\n            >\n                <span>{icon}</span>\n                {title}\n\n                {/* Health Indicators */}\n                {health.status === 'critical' && <span title=\"Critical: Feed yield < 10% of average\" style={{ marginLeft: '8px' }}>üî¥</span>}\n                {health.status === 'warning' && <span title=\"Warning: Feed yield < 50% of average\" style={{ marginLeft: '8px' }}>‚ö†Ô∏è</span>}\n                {isSingleSource && news.length > 3 && <span title=\"Single Source: Potential echo chamber\" style={{ marginLeft: '8px' }}>üì°</span>}\n\n                {news.length > 0 && (\n                    <span style={{ opacity: 0.6, fontSize: '0.9em', marginLeft: '6px' }}>({news.length})</span>\n                )}\n\n                {/* Collapse Indicator */}\n                <span style={{ marginLeft: '8px', fontSize: '0.8em', opacity: 0.5 }}>\n                    {isCollapsed ? '‚ñº' : '‚ñ≤'}\n                </span>\n\n                {/* Data Age Badge */}\n                {news.length > 0 && news[0].fetchedAt && (\n                    <span style={{\n                        fontSize: '0.65rem',\n                        marginLeft: 'auto',\n                        padding: '2px 6px',\n                        borderRadius: '4px',\n                        background: (Date.now() - news[0].fetchedAt) < 3600000 ? 'rgba(0, 255, 0, 0.2)' : 'rgba(255, 165, 0, 0.2)',\n                        color: (Date.now() - news[0].fetchedAt) < 3600000 ? '#4caf50' : '#ffa726',\n                        border: '1px solid currentColor',\n                        fontWeight: 'normal'\n                    }}>\n                        {(Date.now() - news[0].fetchedAt) < 300000 ? 'LIVE' : getTimeAgo(news[0].fetchedAt)}\n                    </span>\n                )}\n            </h2>\n\n            {!isCollapsed && renderContent()}\n        </section>\n    );\n}\n\nexport default NewsSection;\n"],"names":["NewsSection","id","title","icon","colorClass","news","maxDisplay","showExpand","error","extraContent","onArticleClick","showCritics","expanded","setExpanded","useState","isCollapsed","setIsCollapsed","auditResults","useNews","trendingThreshold","getSettings","displayCount","displayNews","hasMore","health","isSingleSource","getImpactStars","score","getConfidenceClass","confidence","getTimeAgo","timestamp","seconds","interval","handleStoryClick","item","addReadArticle","renderContent","jsxs","jsx","Fragment","idx"],"mappings":"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"}