import{j as e,a as b,u as N,c as C}from"./index-Cu5lRAYs.js";import{b as j}from"./vendor-react-BMB3rUHI.js";import{W as v,C as y,H as k,a as S,U as I}from"./AppIcons-C6ymHZs0.js";import"./utils-sentiment-EAYl0nxh.js";const W=({weatherData:n,activeCity:a,onRefresh:g,loading:p,isDesktop:i})=>{const m=a||Object.keys(n)[0]||"chennai",c=n[m]||n[m.toLowerCase()],u=j.useMemo(()=>{if(!c)return"Loading weather data...";const t=c.current||{},r=c.next8Hours||[],h=c.hourly24||[];let o=t.high;if((o==null||o===void 0)&&h.length>0){const w=Math.max(...h.map(x=>x.temp||-999));w!==-999&&(o=w)}const l=o!=null?`${o}¬∞`:"--";let s="";const d=r.slice(0,4).find(w=>w.precip>.5||w.prob>=40);d?s=`Rain likely at ${d.label}`:t.windSpeed>25?s=`Windy (${t.windSpeed} km/h)`:t.temp>38||o>38?s="Heatwave Alert":t.humidity>85&&t.temp>30?s="High Humidity":t.condition&&t.condition.toLowerCase().includes("rain")&&(s="Raining Now");let f=`${t.condition||"Clear"} ‚Ä¢ High ${l}`;return s?`${f} ‚Ä¢ ${s}`:f},[c]);return e.jsxs("div",{style:{position:"sticky",top:0,zIndex:100,background:"linear-gradient(to bottom, var(--bg-card), var(--bg-primary))",borderBottom:"1px solid var(--border-default)",boxShadow:"0 4px 20px rgba(0,0,0,0.4)",padding:"16px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("h2",{style:{fontSize:"1.4rem",margin:0,fontWeight:800,background:"linear-gradient(135deg, #fff 0%, #aaa 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",textTransform:"capitalize",letterSpacing:"-0.02em",lineHeight:1.1},children:m}),p&&e.jsx("span",{className:"pulse-dot",style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--accent-primary)",display:"inline-block",boxShadow:"0 0 10px var(--accent-primary)"}})]}),e.jsx("div",{style:{fontSize:"0.95rem",color:"var(--accent-info)",fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:i?"auto":"280px",opacity:.9},children:u})]}),e.jsx("button",{onClick:g,style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"50%",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"var(--text-primary)",opacity:p?.7:1,transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},title:"Refresh Weather",children:e.jsx("span",{style:{display:"block",transform:p?"rotate(360deg)":"none",transition:"transform 1s linear infinite",fontSize:"18px"},children:p?"‚ü≥":"‚Üª"})})]})};function T({weatherData:n,activeCity:a,setActiveCity:g}){const{settings:p}=b(),i=(p.weather?.cities||["chennai","trichy","muscat"]).map(s=>s.toLowerCase()),m={chennai:"Chennai",trichy:"Trichy",muscat:"Muscat",[i[2]]:i[2].charAt(0).toUpperCase()+i[2].slice(1)},c={chennai:"üèõÔ∏è",trichy:"üèØ",muscat:"üìç",[i[2]]:"üìç"},[u,t]=j.useState(null);if(!n)return null;const r=n[a]||n.chennai;if(!r)return e.jsx("div",{className:"dw-container",children:"Data unavailable"});const h=new Date().getHours();let o=[];const l=(s,d,f=null)=>{s==="today"||r.tomorrow;const w=s==="today"?r[d]:r.tomorrow?.[d];let x=f;return x||(d==="morning"?x="Morning":d==="noon"?x="Afternoon":x="Evening",s==="tomorrow"&&(x="Tomorrow "+x)),{id:`${s}-${d}`,label:x,data:w}};return h<11?o=[l("today","morning","This Morning"),l("today","noon"),l("today","evening")]:h<17?o=[l("today","noon","This Afternoon"),l("today","evening"),l("tomorrow","morning")]:h<21?o=[l("today","evening","Tonight"),l("tomorrow","morning"),l("tomorrow","noon")]:o=[l("tomorrow","morning","Tomorrow Morning"),l("tomorrow","noon"),l("tomorrow","evening")],e.jsxs("div",{className:"dw-container",children:[e.jsx("div",{className:"dw-sidebar",children:i.map(s=>e.jsxs("button",{className:`dw-city-tab ${s===a?"active":""}`,onClick:()=>g(s),"aria-label":`Select ${m[s]}`,children:[e.jsx("span",{className:"dw-city-icon",children:c[s]||"üìç"}),e.jsx("span",{className:"dw-city-name",children:m[s]||s})]},s))}),e.jsxs("div",{className:"dw-content",children:[e.jsxs("div",{className:"dw-header",children:[e.jsxs("div",{className:"dw-header-main",children:[e.jsx("h2",{className:"dw-city-title",children:r.name}),e.jsxs("span",{className:"dw-current-temp",children:[r.current?.temp,"¬∞"]})]}),e.jsx("div",{className:"dw-header-sub",children:r.summary})]}),e.jsx("div",{className:"dw-cards-list",children:o.map((s,d)=>s.data?e.jsx(H,{segment:s,isExpanded:u===d,onToggle:()=>t(u===d?null:d)},s.id):null)}),e.jsxs("div",{className:"dw-footer",children:["Forecast based on ",r.models?.count," models (",r.models?.names,")."]})]})]})}function H({segment:n,isExpanded:a,onToggle:g}){const{label:p,data:i}=n,m=parseFloat(i.rainMm==="-"?0:i.rainMm),c=i.rainProb?.avg||0,u=m>=1,t=m>0||c>0;let r=y,h="var(--text-secondary)",o="No significant rain";t&&(u?(r=I,h="#3b82f6"):(r=y,h="#94a3b8"),o=`${m>0?m.toFixed(1)+"mm":"Trace"} (${c}%)`);const l=$(i);return e.jsxs("div",{className:`dw-card ${a?"expanded":""}`,onClick:g,children:[e.jsxs("div",{className:"dw-card-header",children:[e.jsx("span",{className:"dw-period-badge",children:p}),e.jsx("span",{className:"dw-expand-hint",children:a?"Collapse":"Touch for Hourly"})]}),e.jsxs("div",{className:"dw-card-main",children:[e.jsx("div",{className:"dw-main-icon",children:i.iconId?e.jsx(v,{id:i.iconId,size:56}):e.jsx("span",{style:{fontSize:"3rem"},children:i.icon})}),e.jsxs("div",{className:"dw-main-temp",children:[e.jsxs("div",{className:"dw-temp-val",children:[i.temp,"¬∞"]}),e.jsxs("div",{className:"dw-temp-feels",children:["Feels like ",i.feelsLike,"¬∞"]})]})]}),e.jsxs("div",{className:"dw-details-grid",children:[e.jsxs("div",{className:"dw-detail-row",children:[e.jsx("div",{className:"dw-detail-icon",children:e.jsx(r,{size:20,color:h})}),e.jsx("div",{className:"dw-detail-text",children:o})]}),e.jsxs("div",{className:"dw-detail-row",children:[e.jsx("div",{className:"dw-detail-icon",children:e.jsx(k,{size:20})}),e.jsxs("div",{className:"dw-detail-text",children:[i.humidity,"% ",e.jsx("span",{className:"dw-sep",children:"|"})," ",e.jsx(S,{size:16})," ",i.windSpeed," km/h"]})]}),e.jsxs("div",{className:"dw-detail-row",children:[e.jsx("div",{className:"dw-detail-icon",children:"‚òÄÔ∏è"}),e.jsxs("div",{className:"dw-detail-text",children:["UV: ",i.uvIndex||"-"," ",e.jsx("span",{className:"dw-sep",children:"|"})," PM 2.5: -"]})]}),e.jsxs("div",{className:"dw-detail-row",children:[e.jsx("div",{className:"dw-detail-icon",children:"‚ÑπÔ∏è"}),e.jsx("div",{className:"dw-detail-text dw-desc",children:l})]})]}),a&&i.hourly&&e.jsx("div",{className:"dw-hourly-container hide-scrollbar",onClick:s=>s.stopPropagation(),children:i.hourly.map((s,d)=>e.jsxs("div",{className:"dw-hourly-slot",children:[e.jsx("span",{className:"dw-slot-time",children:s.time}),e.jsx("div",{className:"dw-slot-icon",children:s.iconId?e.jsx(v,{id:s.iconId,size:28}):s.icon}),e.jsxs("strong",{className:"dw-slot-temp",children:[s.temp,"¬∞"]}),s.precip>0&&e.jsxs("span",{className:"dw-slot-precip",children:[s.precip>=1&&e.jsx("span",{style:{fontSize:"0.7rem"},children:"‚òÇÔ∏è"}),s.precip,"mm"]})]},d))})]})}function $(n){const a=[];return n.rainProb?.avg>40?a.push("Rain expected."):n.cloudCover>70?a.push("Cloudy."):n.cloudCover<20&&a.push("Clear skies."),n.windSpeed>20&&a.push("Breezy."),n.uvIndex>8&&a.push("High UV."),a.length===0?"Pleasant conditions.":a.join(" ")}function F(){const{weatherData:n,loading:a,error:g,refreshWeather:p}=N(),{settings:i}=b(),{isDesktop:m}=C(),c=n,u=(i.weather?.cities||["chennai","trichy","muscat"]).map(o=>o.toLowerCase()),[t,r]=j.useState(()=>localStorage.getItem("dw_active_city")||"chennai");j.useEffect(()=>{localStorage.setItem("dw_active_city",t)},[t]);const h=()=>{p(!0)};return a&&!n?e.jsx("div",{className:"page-container",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:e.jsxs("div",{className:"loading",children:[e.jsx("div",{className:"loading__spinner"}),e.jsx("span",{children:"Loading Forecast..."})]})}):e.jsxs("div",{className:"page-container",style:{padding:0},children:[c&&e.jsx(W,{weatherData:c,activeCity:t,cities:u,onRefresh:h,loading:a,isDesktop:m}),e.jsxs("main",{className:"main-content",style:{padding:0,marginTop:0},children:[g&&e.jsxs("div",{className:"topline",style:{borderLeftColor:"var(--accent-danger)",margin:"16px"},children:[e.jsx("div",{className:"topline__label",style:{color:"var(--accent-danger)"},children:"Error"}),e.jsx("div",{className:"topline__text",children:"Failed to update weather. Showing cached data."})]}),c?e.jsx(T,{weatherData:c,activeCity:t,setActiveCity:r}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state__icon",children:"‚òÅÔ∏è"}),e.jsx("p",{children:"Weather data unavailable."}),e.jsx("button",{onClick:h,className:"btn btn--secondary mt-md",children:"Retry"})]})]})]})}export{F as default};
//# sourceMappingURL=WeatherPage-CZvqb4Xs.js.map
