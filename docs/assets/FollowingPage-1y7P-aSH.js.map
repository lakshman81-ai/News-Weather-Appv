{"version":3,"file":"FollowingPage-1y7P-aSH.js","sources":["../../src/components/TopicCard.jsx","../../src/components/TopicSearch.jsx","../../src/pages/FollowingPage.jsx"],"sourcesContent":["import React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './TopicCard.css';\n\nexport function TopicCard({ topic, articleCount, onClick, onRemove }) {\n    const navigate = useNavigate();\n\n    // Check if we need to show time ago\n    const timeAgo = topic.lastFetched\n        ? getRelativeTime(new Date(topic.lastFetched))\n        : 'Never updated';\n\n    const handleClick = () => {\n        // If onClick prop is passed, use it, otherwise navigate\n        if (onClick) {\n            onClick(topic);\n        } else {\n            navigate(`/following/${topic.id}`);\n        }\n    };\n\n    return (\n        <div className=\"topic-card\" onClick={handleClick}>\n            <div className=\"topic-card__icon\">{topic.icon || 'üì∞'}</div>\n            <div className=\"topic-card__content\">\n                <h3 className=\"topic-card__name\">{topic.name}</h3>\n                <p className=\"topic-card__update\">Last update: {timeAgo}</p>\n            </div>\n            <div className=\"topic-card__badge\">\n                {articleCount > 0 && (\n                    <span className=\"topic-card__count\">{articleCount} new</span>\n                )}\n            </div>\n            <button\n                className=\"topic-card__menu\"\n                onClick={(e) => {\n                    e.stopPropagation();\n                    // Confirm? Maybe not, just remove.\n                    if (window.confirm(`Stop following \"${topic.name}\"?`)) {\n                        onRemove(topic.id);\n                    }\n                }}\n                aria-label=\"Remove topic\"\n            >\n                ‚ãÆ\n            </button>\n        </div>\n    );\n}\n\nfunction getRelativeTime(date) {\n    if (!date) return 'Never';\n    const mins = Math.floor((Date.now() - date) / 60000);\n    if (mins < 1) return 'Just now';\n    if (mins < 60) return `${mins} min${mins > 1 ? 's' : ''} ago`;\n    const hours = Math.floor(mins / 60);\n    if (hours < 24) return `${hours} hour${hours > 1 ? 's' : ''} ago`;\n    return `${Math.floor(hours / 24)} days ago`;\n}\n","import React, { useState } from 'react';\nimport { buildTopicQuery } from '../utils/topicQueryBuilder.js';\nimport { fetchAndParseFeed } from '../services/rssAggregator.js';\nimport './TopicSearch.css';\n\nexport function TopicSearch({ onAddTopic }) {\n    const [query, setQuery] = useState('');\n    const [previewArticles, setPreviewArticles] = useState([]);\n    const [searching, setSearching] = useState(false);\n\n    const handleSearch = async (e) => {\n        e.preventDefault();\n        if (!query.trim()) return;\n\n        setSearching(true);\n        try {\n            // Use 'preview' context or just generic RSS fetch\n            const feedUrl = buildTopicQuery(query);\n            const articles = await fetchAndParseFeed(feedUrl, 'preview');\n            setPreviewArticles(articles.slice(0, 5)); // Show top 5\n        } catch (error) {\n            console.error('Search failed:', error);\n            alert('Failed to find news for this topic. Try different keywords.');\n        } finally {\n            setSearching(false);\n        }\n    };\n\n    const handleFollow = () => {\n        const newTopic = {\n            name: query, // User can edit name? Simplify for now.\n            query: query,\n            icon: suggestIcon(query),\n            options: {\n                country: 'IN',\n                lang: 'en',\n                timeRange: '30d'\n            }\n        };\n\n        onAddTopic(newTopic);\n        setQuery('');\n        setPreviewArticles([]);\n    };\n\n    return (\n        <div className=\"topic-search\">\n            <form onSubmit={handleSearch}>\n                <input\n                    type=\"text\"\n                    placeholder=\"Search topics... (e.g., Tamil Nadu Elections)\"\n                    value={query}\n                    onChange={(e) => setQuery(e.target.value)}\n                    className=\"topic-search__input\"\n                />\n                <button type=\"submit\" disabled={searching}>\n                    {searching ? '...' : 'Search'}\n                </button>\n            </form>\n\n            {previewArticles.length > 0 && (\n                <div className=\"topic-search__preview\">\n                    <h4>Preview: \"{query}\"</h4>\n                    <ul>\n                        {previewArticles.map((article, idx) => (\n                            <li key={idx}>{article.title}</li>\n                        ))}\n                    </ul>\n                    <button onClick={handleFollow} className=\"topic-search__follow-btn\">\n                        ‚ûï Follow \"{query}\"\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n}\n\nfunction suggestIcon(query) {\n    const q = query.toLowerCase();\n    if (q.includes('election')) return 'üó≥Ô∏è';\n    if (q.includes('market') || q.includes('stock') || q.includes('sensex')) return 'üìä';\n    if (q.includes('film') || q.includes('movie') || q.includes('cinema')) return 'üé¨';\n    if (q.includes('sport') || q.includes('cricket') || q.includes('ipl')) return 'üèè';\n    if (q.includes('tech') || /\\bai\\b/.test(q) || q.includes('startup')) return 'üíª';\n    if (q.includes('weather') || q.includes('rain')) return '‚òÅÔ∏è';\n    return 'üì∞';\n}\n","import React, { useEffect } from 'react';\nimport { useTopics } from '../context/TopicContext.jsx';\nimport { TopicCard } from '../components/TopicCard.jsx';\nimport { TopicSearch } from '../components/TopicSearch.jsx';\nimport './FollowingPage.css';\n\nexport default function FollowingPage() {\n    const {\n        followedTopics,\n        topicNews,\n        loading,\n        suggestions,\n        addTopic,\n        removeTopic,\n        refreshTopics\n    } = useTopics();\n\n    useEffect(() => {\n        // Trigger a silent refresh if needed, but context handles polling\n    }, []);\n\n    const hasTopics = followedTopics.length > 0;\n\n    const handleSuggestionClick = (word) => {\n        const newTopic = {\n            name: word,\n            query: word,\n            icon: 'üîç',\n            options: { country: 'IN', lang: 'en', timeRange: '30d' }\n        };\n        addTopic(newTopic);\n    };\n\n    return (\n        <div className=\"following-page\">\n            <header className=\"following-page__header\">\n                <h1>üìå Following</h1>\n            </header>\n\n            <div className=\"following-page__content\">\n                <TopicSearch onAddTopic={addTopic} />\n\n                {suggestions.length > 0 && (\n                    <div className=\"following-page__suggestions-section\">\n                        <h4>Suggested for you</h4>\n                        <div className=\"following-page__suggestions\">\n                            {suggestions.map((s, i) => (\n                                <button\n                                    key={i}\n                                    className=\"suggestion-chip\"\n                                    onClick={() => handleSuggestionClick(s.word)}\n                                >\n                                    + {s.word}\n                                </button>\n                            ))}\n                        </div>\n                    </div>\n                )}\n\n                {loading && <p>Loading updates...</p>}\n\n                {hasTopics ? (\n                    <div className=\"following-page__topics\">\n                        <h2 className=\"following-page__section-title\">Your Topics</h2>\n                        {followedTopics.map(topic => (\n                            <TopicCard\n                                key={topic.id}\n                                topic={topic}\n                                articleCount={topicNews[topic.id]?.length || 0}\n                                onRemove={removeTopic}\n                            />\n                        ))}\n                    </div>\n                ) : (\n                    <div className=\"following-page__empty\">\n                        <p>No topics followed yet.</p>\n                        <p>Search for topics above to get started!</p>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n"],"names":["TopicCard","topic","articleCount","onClick","onRemove","navigate","useNavigate","timeAgo","getRelativeTime","handleClick","jsxs","jsx","e","date","mins","hours","TopicSearch","onAddTopic","query","setQuery","useState","previewArticles","setPreviewArticles","searching","setSearching","handleSearch","feedUrl","buildTopicQuery","articles","fetchAndParseFeed","error","handleFollow","newTopic","suggestIcon","article","idx","q","FollowingPage","followedTopics","topicNews","loading","suggestions","addTopic","removeTopic","refreshTopics","useTopics","useEffect","hasTopics","handleSuggestionClick","word","s","i"],"mappings":"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"}