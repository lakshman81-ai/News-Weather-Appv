import{a as q,l as Y,j as e,h as Q,D as H,E as Z}from"./index-Cu5lRAYs.js";import{b as S}from"./vendor-react-BMB3rUHI.js";import{H as ee}from"./Header-wyIJ1Xr8.js";import{T as F}from"./Toggle-BCPcvk4N.js";import"./utils-sentiment-EAYl0nxh.js";const te="https://api.allorigins.win/get?url=",se=s=>/\.(xml|rss|atom)$/i.test(s)||/feed|rss|atom/i.test(s),ie=async s=>{try{if(!s)return[];if(se(s))return[{title:"Custom Feed",url:s}];const i=encodeURIComponent(s),p=await(await fetch(`${te}${i}`)).json();if(!p.contents)throw new Error("Failed to fetch page content");const y=new DOMParser().parseFromString(p.contents,"text/html"),r=[];if(y.querySelectorAll('link[rel="alternate"][type="application/rss+xml"], link[rel="alternate"][type="application/atom+xml"]').forEach(C=>{let l=C.getAttribute("href");const T=C.getAttribute("title")||"RSS Feed";if(l&&!l.startsWith("http")){const I=new URL(s);l=new URL(l,I.origin).href}l&&r.push({title:T,url:l})}),r.length===0){const C=["/feed","/rss","/rss.xml","/atom.xml"],l=new URL(s).origin;C.forEach(T=>{r.push({title:`Possible Feed (${T})`,url:`${l}${T}`})})}return r}catch(i){return console.error("Feed discovery failed:",i),[]}},ne="ver.12-02-26 time 17.41",re=()=>{const{settings:s}=q(),[i,m]=S.useState([]),[p,A]=S.useState(null);S.useEffect(()=>{try{Y&&typeof Y.getLogs=="function"?m(Y.getLogs()):m([])}catch(r){console.error("Failed to load logs",r),A(r.message)}},[]);const y=r=>{if(typeof r=="object")try{return JSON.stringify(r)}catch{return"[Circular Object]"}return String(r)};return p?e.jsxs("div",{className:"error-state",children:["Debug Error: ",p]}):e.jsxs("div",{className:"settings-tab-content",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("span",{children:"üêõ"})," Debug Info"]}),e.jsxs("div",{className:"settings-card",children:[e.jsxs("div",{style:{fontSize:"0.8rem",marginBottom:"10px"},children:[e.jsx("strong",{children:"App Version:"})," ",s?.appVersion||"Unknown"]}),e.jsxs("div",{style:{fontSize:"0.8rem",marginBottom:"10px"},children:[e.jsx("strong",{children:"User Agent:"})," ",navigator.userAgent]}),e.jsxs("div",{style:{fontSize:"0.8rem",marginBottom:"10px"},children:[e.jsx("strong",{children:"Screen:"})," ",window.innerWidth,"x",window.innerHeight]})]}),e.jsxs("div",{className:"section-title",children:[e.jsx("span",{children:"üìú"})," Recent Logs"]}),e.jsx("div",{className:"settings-card",style:{maxHeight:"300px",overflowY:"auto",background:"black",color:"#0f0",fontFamily:"monospace",fontSize:"0.7rem",padding:"10px"},children:i.length===0?e.jsx("div",{children:"No logs available."}):i.map((r,h)=>e.jsxs("div",{style:{marginBottom:"4px",borderBottom:"1px solid #333",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:[e.jsxs("span",{style:{color:"#888"},children:["[",new Date(r.timestamp).toLocaleTimeString(),"]"]})," ",e.jsxs("span",{style:{color:r.level==="error"?"red":r.level==="warn"?"orange":"#0f0"},children:[r.level.toUpperCase(),":"]})," ",y(r.message),r.details&&e.jsx("div",{style:{marginLeft:"15px",color:"#aaa",fontSize:"0.65rem"},children:y(r.details)})]},h))}),e.jsx("div",{className:"settings-card",children:e.jsx("button",{className:"btn btn--danger",onClick:()=>{window.confirm("Clear all data?")&&(localStorage.clear(),window.location.reload())},style:{width:"100%"},children:"Clear All Local Storage & Reload"})})]})},ae=s=>{const i=s||{},m=i.freshness?.maxBoost||3,p=i.source?.tier1Boost||5,A=i.visual?.videoBoost||1.3,y=i.geo?.cityMatch||1.5;let r=0;return m>=2.5&&m<=4?r+=1.5:m>1&&(r+=1),p>=4&&p<=7?r+=1.5:p>=2&&(r+=1),A>=1.2&&A<=1.5?r+=1:r+=.5,y>=1.3&&y<=2?r+=1:r+=.5,Math.min(5,Math.max(1,Math.round(r)))};function xe(){const{settings:s,updateSettings:i,reloadSettings:m}=q(),[p,A]=S.useState("general"),[y,r]=S.useState(!1),[h,C]=S.useState(""),[l,T]=S.useState(!1),[I,R]=S.useState(null),[L,W]=S.useState({}),[E,x]=S.useState(null),[d,o]=S.useState({tier1:"",tier2:"",tier3:""}),[c,M]=S.useState({title:"Breaking: Major Economic Reforms Announced",description:"Government unveils new policy to boost GDP growth by 2%. Markets rally on the news.",source:"BBC News",age:2,section:"business",result:null});if(S.useEffect(()=>{if(!s?.rankingWeights)return;const t={title:c.title,description:c.description,source:c.source,publishedAt:Date.now()-c.age*60*60*1e3,section:c.section,imageUrl:null},n={...s,debugLogs:!0},g=Q(t,c.section,0,n);M(u=>({...u,result:{score:g,breakdown:t._scoreBreakdown}}))},[c.title,c.description,c.source,c.age,c.section,s]),!s)return e.jsx("div",{className:"loading",children:"Loading..."});const k=(t,n)=>{const g=t.split("."),u={...s};let f=u;for(let D=0;D<g.length-1;D++)f[g[D]]={...f[g[D]]},f=f[g[D]];f[g[g.length-1]]=n,i(u)},K=()=>{r(!0),setTimeout(()=>r(!1),2e3),m()},P=()=>{window.confirm("Reset all settings to defaults?")&&(i({...H}),m())},O=(t,n)=>{if(!n||!n.trim())return;const g=t.split(".");let u=s;for(const f of g)u=u?.[f]||[];Array.isArray(u)||(u=[]),u.includes(n.trim())||k(t,[...u,n.trim()])},U=(t,n)=>{const g=t.split(".");let u=s;for(const f of g)u=u?.[f]||[];Array.isArray(u)&&k(t,u.filter(f=>f!==n))},V=(t,n)=>{O(t,n),W({...L,[t]:""})},_=(t,n)=>{if(!n||!n.trim())return;const g=s.sourceTiers?.[t]||[];g.some(u=>u.toLowerCase()===n.trim().toLowerCase())||k(`sourceTiers.${t}`,[...g,n.trim()]),o({...d,[t]:""})},a=(t,n)=>{const g=s.sourceTiers?.[t]||[];k(`sourceTiers.${t}`,g.filter(u=>u!==n))},v=async()=>{if(h){T(!0),R(null);try{const t=await ie(h);if(t.length>0){const n=t[0];i({...s,customFeeds:[...s.customFeeds||[],{title:n.title,url:n.url}]}),C("")}else R("No feeds found.")}catch{R("Error discovering feeds.")}finally{T(!1)}}},B=t=>{const n=[...s.customFeeds||[]];n.splice(t,1),i({...s,customFeeds:n})},z=()=>{const t={settings:s,hiddenEvents:JSON.parse(localStorage.getItem("upAhead_hiddenEvents")||"[]"),watchlist:JSON.parse(localStorage.getItem("upAhead_watchlist")||"[]"),readingHistory:s.readingHistory||[]},n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t,null,2)),g=document.createElement("a");g.setAttribute("href",n),g.setAttribute("download","news_app_full_backup.json"),document.body.appendChild(g),g.click(),g.remove()},N=t=>{const n=t.target.files[0];if(!n)return;const g=new FileReader;g.onload=u=>{try{const f=JSON.parse(u.target.result);window.confirm("Replace current settings, hidden events, and watchlist with imported data?")&&(f.settings?(i(f.settings),f.hiddenEvents&&localStorage.setItem("upAhead_hiddenEvents",JSON.stringify(f.hiddenEvents)),f.watchlist&&localStorage.setItem("upAhead_watchlist",JSON.stringify(f.watchlist))):i(f),m())}catch{alert("Invalid backup file")}},g.readAsText(n)},G=[{id:"general",label:"General",icon:"‚öôÔ∏è"},{id:"ranking",label:"Ranking & Logic",icon:"üß†"},{id:"weather",label:"Weather",icon:"üå§Ô∏è"},{id:"sources",label:"Sources",icon:"üì°"},{id:"market",label:"Market",icon:"üìà"},{id:"sandbox",label:"Sandbox",icon:"üß™"},{id:"advanced",label:"Advanced",icon:"üîß"},{id:"debug",label:"Debug",icon:"üêõ"}],X=()=>{switch(p){case"general":return e.jsxs("div",{className:"settings-tab-content",children:[e.jsx(j,{icon:"üì±",title:"Interface"}),e.jsxs(w,{children:[e.jsx(b,{label:"Home Layout",subLabel:"Timeline / Classic / Newspaper",children:e.jsxs("select",{value:s.uiMode||"timeline",onChange:t=>i({...s,uiMode:t.target.value}),className:"settings-select",children:[e.jsx("option",{value:"timeline",children:"üì± Timeline"}),e.jsx("option",{value:"classic",children:"üìä Classic"}),e.jsx("option",{value:"newspaper",children:"üì∞ Newspaper"})]})}),e.jsx(b,{label:"Font Size",subLabel:`${s.fontSize||26}px`,children:e.jsx("input",{type:"range",min:"14",max:"34",step:"1",value:s.fontSize||26,onChange:t=>i({...s,fontSize:parseInt(t.target.value)}),style:{width:"100%"}})})]}),e.jsx(j,{icon:"ü§ñ",title:"AI Configuration"}),e.jsx(w,{children:e.jsxs("div",{className:"settings-item",style:{flexDirection:"column",alignItems:"stretch"},children:[e.jsxs("div",{className:"settings-item__label",children:[e.jsx("span",{children:"Gemini API Key"}),e.jsx("small",{style:{display:"block",color:"var(--text-muted)",fontSize:"0.65rem"},children:"Required for client-side fallback."})]}),e.jsx("input",{type:"password",value:s.geminiKey||"",onChange:t=>i({...s,geminiKey:t.target.value}),className:"settings-input",placeholder:"Enter API Key"})]})}),e.jsx(j,{icon:"üìà",title:"Market Data"}),e.jsx(w,{children:e.jsxs("div",{className:"settings-item",style:{flexDirection:"column",alignItems:"stretch"},children:[e.jsx("div",{className:"settings-item__label",children:e.jsx("span",{children:"Alpha Vantage API Key"})}),e.jsx("input",{type:"password",value:s.alphaVantageKey||"",onChange:t=>i({...s,alphaVantageKey:t.target.value}),className:"settings-input",placeholder:"Enter AV Key"})]})})]});case"ranking":return e.jsx(le,{settings:s,updateNested:k,updateSettings:i,addToList:O,removeFromList:U});case"weather":return e.jsxs("div",{className:"settings-tab-content",children:[e.jsx(j,{icon:"üìç",title:"Locations"}),e.jsxs(w,{children:[e.jsx("div",{className:"settings-item__label",style:{marginBottom:"10px"},children:"Active Cities"}),e.jsxs("div",{style:{display:"grid",gap:"10px",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{width:"20px"},children:"1."}),e.jsx("input",{type:"text",value:"Chennai",disabled:!0,className:"settings-input",style:{opacity:.7}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{width:"20px"},children:"2."}),e.jsx("input",{type:"text",value:"Trichy",disabled:!0,className:"settings-input",style:{opacity:.7}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{width:"20px"},children:"3."}),e.jsx("input",{type:"text",value:s.weather?.cities?.[2]||"Muscat",onChange:t=>{const n=[...s.weather?.cities||["chennai","trichy","muscat"]];n[2]=t.target.value,k("weather.cities",n)},className:"settings-input",placeholder:"Enter city..."})]})]})]}),e.jsx(j,{icon:"üå§Ô∏è",title:"Weather Models"}),e.jsxs(w,{children:[e.jsx(b,{label:"ECMWF (European)",children:e.jsx(F,{checked:s.weather?.models?.ecmwf!==!1,onChange:t=>k("weather.models.ecmwf",t)})}),e.jsx(b,{label:"GFS (NOAA)",children:e.jsx(F,{checked:s.weather?.models?.gfs!==!1,onChange:t=>k("weather.models.gfs",t)})}),e.jsx(b,{label:"ICON (DWD)",children:e.jsx(F,{checked:s.weather?.models?.icon!==!1,onChange:t=>k("weather.models.icon",t)})})]})]});case"sources":return e.jsxs("div",{className:"settings-tab-content",children:[e.jsx(j,{icon:"üì°",title:"News Sources"}),e.jsxs(w,{children:[e.jsxs("div",{className:"settings-item",style:{borderBottom:"1px solid var(--accent-danger)",background:"rgba(220, 38, 38, 0.15)",padding:"10px"},children:[e.jsxs("div",{className:"settings-item__label",style:{color:"var(--accent-danger)"},children:[e.jsx("span",{children:"üèÜ Top Websites Only"}),e.jsx("small",{style:{display:"block",color:"var(--text-muted)"},children:"BBC, Reuters, NDTV, Hindu, TOI..."})]}),e.jsx(F,{checked:s.topWebsitesOnly===!0,onChange:t=>i({...s,topWebsitesOnly:t})})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",padding:"10px"},children:Object.keys(s.newsSources||{}).map(t=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"0.8rem"},children:[e.jsx("input",{type:"checkbox",checked:s.newsSources?.[t]!==!1,onChange:n=>k(`newsSources.${t}`,n.target.checked),disabled:s.topWebsitesOnly}),t]},t))})]}),e.jsx(j,{icon:"üèÜ",title:"Source Tiers"}),e.jsxs(w,{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginBottom:"15px"},children:"Classify sources to boost their ranking score."}),e.jsx($,{label:`Tier 1 (High Boost: ${s.rankingWeights?.source?.tier1Boost||.5}x)`,placeholder:"e.g. BBC, Reuters",value:d.tier1,onChange:t=>o({...d,tier1:t}),onAdd:()=>_("tier1",d.tier1),items:s.sourceTiers?.tier1||[],onRemove:t=>a("tier1",t)}),e.jsx($,{label:`Tier 2 (Medium Boost: ${s.rankingWeights?.source?.tier2Boost||.2}x)`,placeholder:"e.g. NDTV, Hindu",value:d.tier2,onChange:t=>o({...d,tier2:t}),onAdd:()=>_("tier2",d.tier2),items:s.sourceTiers?.tier2||[],onRemove:t=>a("tier2",t)}),e.jsx($,{label:`Tier 3 (No Boost: ${s.rankingWeights?.source?.tier3Boost||0}x)`,placeholder:"e.g. Local Blogs",value:d.tier3,onChange:t=>o({...d,tier3:t}),onAdd:()=>_("tier3",d.tier3),items:s.sourceTiers?.tier3||[],onRemove:t=>a("tier3",t)})]}),e.jsx(j,{icon:"üîó",title:"Custom Feeds"}),e.jsxs(w,{children:[e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"10px"},children:[e.jsx("input",{type:"text",value:h,onChange:t=>C(t.target.value),placeholder:"RSS URL...",className:"settings-input"}),e.jsx("button",{className:"btn btn--primary",onClick:v,disabled:l,children:l?"...":"Add"})]}),I&&e.jsx("div",{style:{color:"red",fontSize:"0.75rem"},children:I}),s.customFeeds?.map((t,n)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.8rem",padding:"5px 0"},children:[e.jsx("span",{children:t.title||t.url}),e.jsx("button",{onClick:()=>B(n),style:{color:"red"},children:"‚úï"})]},n))]})]});case"upahead":return null;case"market":return e.jsxs("div",{className:"settings-tab-content",children:[e.jsx(j,{icon:"üìà",title:"Market Display"}),e.jsx(w,{children:Object.keys(s.market||{}).filter(t=>t.startsWith("show")).map(t=>e.jsx(b,{label:t.replace("show",""),children:e.jsx(F,{checked:s.market?.[t]!==!1,onChange:n=>k(`market.${t}`,n)})},t))})]});case"logic":return null;case"sandbox":return e.jsxs("div",{className:"settings-tab-content",children:[e.jsx(j,{icon:"üß™",title:"Ranking Sandbox"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginBottom:"15px"},children:`Simulate how the current settings affect an article's score. Change settings in the "Custom Ranking" tab to see impact here.`}),e.jsx(w,{children:e.jsxs("div",{style:{display:"grid",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"4px"},children:"Title"}),e.jsx("input",{className:"settings-input",value:c.title,onChange:t=>M({...c,title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"4px"},children:"Description"}),e.jsx("textarea",{className:"settings-input",style:{resize:"vertical",minHeight:"60px"},value:c.description,onChange:t=>M({...c,description:t.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"4px"},children:"Source"}),e.jsxs("select",{className:"settings-select",value:c.source,onChange:t=>M({...c,source:t.target.value}),style:{width:"100%"},children:[e.jsx("option",{value:"BBC News",children:"BBC (Tier 1)"}),e.jsx("option",{value:"Unknown Blog",children:"Blog (Tier 3)"}),e.jsx("option",{value:"NDTV",children:"NDTV (Tier 2)"}),e.jsx("option",{value:"TechCrunch",children:"TechCrunch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"4px"},children:"Section"}),e.jsxs("select",{className:"settings-select",value:c.section,onChange:t=>M({...c,section:t.target.value}),style:{width:"100%"},children:[e.jsx("option",{value:"world",children:"World (High Priority)"}),e.jsx("option",{value:"business",children:"Business"}),e.jsx("option",{value:"technology",children:"Technology"}),e.jsx("option",{value:"general",children:"General"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"4px"},children:["Age: ",c.age," hours"]}),e.jsx("input",{type:"range",min:"0",max:"72",step:"1",value:c.age,onChange:t=>M({...c,age:parseInt(t.target.value)}),style:{width:"100%"}})]})]})}),c.result&&e.jsxs("div",{className:"settings-card",style:{border:"1px solid var(--accent-primary)",background:"rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"CALCULATED SCORE"}),e.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"var(--accent-primary)"},children:c.result.score.toFixed(1)})]}),e.jsx("div",{style:{padding:"10px",fontSize:"0.75rem"},children:e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsx("tbody",{children:Object.entries(c.result.breakdown||{}).map(([t,n])=>t==="total"||typeof n!="number"?null:e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("td",{style:{padding:"4px",textTransform:"capitalize",color:"var(--text-secondary)"},children:t.replace(/([A-Z])/g," $1").trim()}),e.jsxs("td",{style:{padding:"4px",textAlign:"right",fontWeight:"bold",color:n>1.5?"#4f4":n<.5?"#f44":"#fff"},children:[n.toFixed(2),t.toLowerCase().includes("boost")||t.toLowerCase().includes("multiplier")?"x":""]})]},t))})})})]})]});case"advanced":return e.jsxs("div",{className:"settings-tab-content",children:[e.jsx(j,{icon:"üîß",title:"Advanced"}),e.jsxs(w,{children:[e.jsx(b,{label:"Enable News Cache",subLabel:"Faster loads, 5min TTL",children:e.jsx(F,{checked:s.enableCache!==!1,onChange:t=>i({...s,enableCache:t})})}),e.jsx(b,{label:"Crawler Mode",children:e.jsxs("select",{value:s.crawlerMode||"auto",onChange:t=>i({...s,crawlerMode:t.target.value}),className:"settings-select",children:[e.jsx("option",{value:"auto",children:"Auto"}),e.jsx("option",{value:"manual",children:"Manual"})]})}),e.jsx(b,{label:"Debug Logs",children:e.jsx(F,{checked:s.debugLogs===!0,onChange:t=>i({...s,debugLogs:t})})})]}),e.jsx(j,{icon:"üïµÔ∏è",title:"Impact & Priority"}),e.jsxs(w,{children:[e.jsx(b,{label:"üí• Base Impact Weight",subLabel:"Multiplier",children:e.jsx("input",{type:"range",min:"0.5",max:"3.0",step:"0.1",value:s.rankingWeights?.impact?.boost||1,onChange:t=>k("rankingWeights.impact.boost",parseFloat(t.target.value)),style:{width:"100%"}})}),e.jsx(b,{label:"üî• High Impact Boost",subLabel:"Triggers on Major Event Keywords",children:e.jsx("input",{type:"range",min:"1.0",max:"5.0",step:"0.1",value:s.rankingWeights?.impact?.highImpactBoost||2.5,onChange:t=>k("rankingWeights.impact.highImpactBoost",parseFloat(t.target.value)),style:{width:"100%"}})}),e.jsx($,{label:"Major Event Keywords",placeholder:"e.g. Budget, Treaty, War",value:L.highImpact,onChange:t=>W({...L,highImpact:t}),onAdd:()=>V("highImpactKeywords",L.highImpact),items:s.highImpactKeywords||[],onRemove:t=>U("highImpactKeywords",t)}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"5px"},children:["‚ÑπÔ∏è Articles containing these words receive the ",e.jsx("strong",{children:"High Impact Boost"})," (above)."]})]}),e.jsx(j,{icon:"‚ö°",title:"Buzz Ranking"}),e.jsxs(w,{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginBottom:"15px"},children:'Configuration for "Buzz" and "Social" sections.'}),e.jsx(b,{label:"üì∏ Visual Boost",subLabel:"Videos/Images",children:e.jsx("input",{type:"range",min:"1.0",max:"3.0",step:"0.1",value:s.buzzRankingWeights?.visual?.videoBoost||2,onChange:t=>k("buzzRankingWeights.visual.videoBoost",parseFloat(t.target.value)),style:{width:"100%"}})}),e.jsx(b,{label:"üî• Trend Threshold",subLabel:"Lower = More Trending",children:e.jsx("input",{type:"range",min:"5",max:"20",step:"1",value:s.buzzRankingWeights?.trending?.threshold||10,onChange:t=>k("buzzRankingWeights.trending.threshold",parseFloat(t.target.value)),style:{width:"100%"}})})]}),e.jsx(j,{icon:"üîÑ",title:"Backup & Sync"}),e.jsxs(w,{children:[e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{className:"btn btn--secondary",onClick:z,style:{flex:1},children:"Export Backup"}),e.jsxs("label",{className:"btn btn--secondary",style:{flex:1,cursor:"pointer",textAlign:"center"},children:["Import Backup",e.jsx("input",{type:"file",accept:".json",onChange:N,style:{display:"none"}})]})]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"8px"},children:"Saves Settings, Hidden Events (Plan My Week), and Watchlist to a file."})]})]});case"debug":return e.jsx(re,{});default:return null}};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[e.jsx(ee,{title:"Settings",showBack:!0,backTo:"/",compact:!0,style:{flex:"0 0 auto"}}),e.jsxs("div",{className:"settings-layout",children:[e.jsx("div",{className:"settings-sidebar",children:G.map(t=>e.jsxs("button",{className:`settings-tab-btn ${p===t.id?"active":""}`,onClick:()=>A(t.id),children:[e.jsx("span",{className:"tab-icon",children:t.icon}),e.jsx("span",{className:"tab-label",children:t.label})]},t.id))}),e.jsxs("div",{className:"settings-content",children:[e.jsx("div",{className:"settings-scroll-area",style:{overflowY:p==="ranking"?"hidden":"auto",padding:p==="ranking"?0:"15px"},children:X()}),e.jsxs("div",{className:"settings-footer",children:[e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[e.jsx("button",{className:"btn btn--danger",onClick:P,style:{flex:1},children:"Reset"}),e.jsx("button",{className:"btn btn--primary",onClick:K,style:{flex:1},children:y?"‚úì Saved":"Save"})]}),e.jsx("div",{className:"version-tag",children:ne})]})]})]}),e.jsx("style",{children:`
                .settings-layout { display: flex; flex: 1; overflow: hidden; background: var(--bg-primary); }
                .settings-sidebar { width: 60px; background: var(--bg-secondary); border-right: 1px solid var(--border-default); display: flex; flex-direction: column; padding: 10px 5px; overflow-y: auto; flex-shrink: 0; }
                .settings-tab-btn { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 12px 5px; border: none; background: transparent; color: var(--text-secondary); cursor: pointer; border-radius: 8px; margin-bottom: 5px; }
                .settings-tab-btn.active { background: var(--accent-primary); color: #fff; }
                .tab-icon { font-size: 1.5rem; } .tab-label { display: none; }
                .settings-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
                .settings-scroll-area { flex: 1; overflow-y: auto; padding: 15px; }
                .settings-footer { flex-shrink: 0; background: var(--bg-secondary); border-top: 1px solid var(--border-default); padding: 15px; }
                .settings-card { background: var(--bg-card); border-radius: var(--radius-md); padding: 15px; margin-bottom: 20px; border: 1px solid var(--border-default); }
                .section-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 12px; color: var(--text-primary); display: flex; align-items: center; gap: 8px; }
                .settings-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
                .settings-item:last-child { border-bottom: none; }
                .settings-select, .settings-input, .settings-input-number { background: var(--bg-secondary); border: 1px solid var(--border-default); color: var(--text-primary); padding: 8px; border-radius: 4px; font-size: 0.85rem; }
                .settings-input { width: 100%; }
                .chip-checkbox { display: flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 16px; border: 1px solid var(--border-default); background: var(--bg-secondary); color: var(--text-primary); font-size: 0.8rem; cursor: pointer; }
                .chip-checkbox.active { background: var(--accent-primary); color: #fff; border-color: var(--accent-primary); }
                .keyword-chip { display: inline-flex; align-items: center; padding: 4px 8px; background: var(--bg-tertiary); border-radius: 4px; margin: 2px; font-size: 0.75rem; }
                .keyword-chip button { background: none; border: none; color: var(--accent-danger); margin-left: 6px; cursor: pointer; padding: 0; }
                .version-tag { text-align: right; font-size: 0.7rem; color: var(--text-muted); margin-top: 8px; font-family: monospace; opacity: 0.7; }
            `})]})}const le=({settings:s,updateNested:i,updateSettings:m,addToList:p,removeFromList:A})=>{const[y,r]=S.useState("main"),[h,C]=S.useState("entertainment"),[l,T]=S.useState("movies"),[I,R]=S.useState({}),L=(d,o)=>R(c=>({...c,[d]:o})),W=()=>{const d=ae(s.rankingWeights||{});return e.jsxs("div",{children:[e.jsx("div",{className:"settings-card",style:{background:"linear-gradient(135deg, rgba(255,215,0,0.1), rgba(0,0,0,0))",border:"1px solid rgba(255,215,0,0.3)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{children:e.jsx("div",{style:{fontWeight:600,color:"#FFD700"},children:"‚òÖ Quality Rating"})}),e.jsxs("div",{style:{fontSize:"1.8rem",color:"#FFD700"},children:["‚òÖ".repeat(d),"‚òÜ".repeat(5-d)]})]})}),e.jsx(j,{icon:"üèÜ",title:"Top Stories & Global"}),e.jsxs(w,{children:[e.jsx(b,{label:"üèÜ Top Stories Boost",subLabel:"Min Score for Top Stories",children:e.jsx("input",{type:"range",min:"8",max:"30",step:"1",value:s.rankingWeights?.trending?.threshold||12,onChange:o=>i("rankingWeights.trending.threshold",parseFloat(o.target.value)),style:{width:"100%"}})}),e.jsx(b,{label:"üìå Keyword Match",subLabel:`+${(s.rankingWeights?.keyword?.matchBoost||2).toFixed(1)} Points`,children:e.jsx("input",{type:"range",min:"0",max:"5",step:"0.5",value:s.rankingWeights?.keyword?.matchBoost||2,onChange:o=>i("rankingWeights.keyword.matchBoost",parseFloat(o.target.value)),style:{width:"100%"}})}),e.jsx(b,{label:"üìç Location Match",subLabel:`${(s.rankingWeights?.geo?.cityMatch||1.5).toFixed(1)}x Multiplier`,children:e.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:s.rankingWeights?.geo?.cityMatch||1.5,onChange:o=>i("rankingWeights.geo.cityMatch",parseFloat(o.target.value)),style:{width:"100%"}})})]}),e.jsx(j,{icon:"üìâ",title:"Freshness & Decay"}),e.jsxs(w,{children:[e.jsxs(b,{label:"üéöÔ∏è Freshness Sensitivity",subLabel:"Left: Stricter (Newer) | Right: Relaxed",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",gap:"10px"},children:[e.jsx("span",{title:"Strict/Fresh",style:{fontSize:"1.2rem"},children:"‚ö°"}),e.jsx("input",{type:"range",min:"6",max:"72",value:s.rankingWeights?.freshness?.decayHours||26,onChange:o=>i("rankingWeights.freshness.decayHours",parseInt(o.target.value)),style:{flex:1}}),e.jsx("span",{title:"Relaxed/Older",style:{fontSize:"1.2rem"},children:"üê¢"})]}),e.jsxs("div",{style:{textAlign:"right",fontSize:"0.7rem",color:"var(--text-muted)"},children:["Decay over ",s.rankingWeights?.freshness?.decayHours||26,"h"]})]}),e.jsx(b,{label:"üìâ Hide Stale News",subLabel:`> ${s.hideOlderThanHours||60}h`,children:e.jsx("input",{type:"number",min:1,max:168,value:s.hideOlderThanHours||60,onChange:o=>m({...s,hideOlderThanHours:parseInt(o.target.value)||60}),className:"settings-input-number",style:{width:"60px"}})})]}),e.jsx(j,{icon:"üß†",title:"Classification Logic"}),e.jsxs(w,{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginBottom:"15px"},children:"Automatic categorization logic."}),e.jsx("div",{className:"settings-item__label",style:{color:"var(--accent-primary)",marginTop:"10px"},children:"Entity Overrides (Exact Matches)"}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"8px",margin:"5px 0 15px 0",fontSize:"0.75rem",fontFamily:"monospace"},children:Object.entries(Z).map(([o,c])=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-primary)"},children:o}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:["‚Üí ",c]})]},o))})]})]})},E=()=>{const d=[{id:"entertainment",label:"Entertain",icon:"üé¨"},{id:"technology",label:"Tech",icon:"üíª"},{id:"sports",label:"Sports",icon:"‚öΩ"},{id:"social",label:"Social",icon:"üî•"}];return e.jsxs("div",{style:{display:"flex",height:"100%",gap:"10px"},children:[e.jsx("div",{style:{width:"70px",flexShrink:0,display:"flex",flexDirection:"column",gap:"5px"},children:d.map(o=>e.jsxs("button",{onClick:()=>C(o.id),style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"8px 4px",border:"none",background:h===o.id?"var(--accent-primary)":"rgba(255,255,255,0.05)",color:h===o.id?"#fff":"var(--text-secondary)",borderRadius:"8px",cursor:"pointer",fontSize:"0.7rem",fontWeight:500},children:[e.jsx("span",{style:{fontSize:"1.3rem",marginBottom:"2px"},children:o.icon}),o.label]},o.id))}),e.jsx("div",{style:{flex:1,overflowY:"auto"},children:h==="social"?e.jsxs("div",{children:[e.jsx(j,{icon:"üî•",title:"Social Trends"}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginBottom:"15px"},children:["Uses ",e.jsx("strong",{children:"Legacy Scoring"})," (Freshness + Source)."]}),e.jsxs(w,{children:[e.jsx(b,{label:"üì∏ Visual Boost",subLabel:"Videos/Images",children:e.jsx("input",{type:"range",min:"1.0",max:"3.0",step:"0.1",value:s.buzzRankingWeights?.visual?.videoBoost||2,onChange:o=>i("buzzRankingWeights.visual.videoBoost",parseFloat(o.target.value)),style:{width:"100%"}})}),e.jsx(b,{label:"üî• Trend Threshold",subLabel:"Lower = More Trending",children:e.jsx("input",{type:"range",min:"5",max:"20",step:"1",value:s.buzzRankingWeights?.trending?.threshold||10,onChange:o=>i("buzzRankingWeights.trending.threshold",parseFloat(o.target.value)),style:{width:"100%"}})})]})]}):e.jsx(J,{title:h.charAt(0).toUpperCase()+h.slice(1),icon:d.find(o=>o.id===h).icon,configPath:`buzz.${h}`,configData:s.buzz?.[h]||{},updateNested:i,addToList:p,removeFromList:A,localInputs:I,handleLocalInput:L,subTab:h})})]})},x=()=>{const d=[{id:"movies",label:"Movies",icon:"üé¨"},{id:"events",label:"Events",icon:"üé§"},{id:"festivals",label:"Festivals",icon:"ü™î"},{id:"sports",label:"Sports",icon:"‚öΩ"},{id:"shopping",label:"Shopping",icon:"üõí"},{id:"airlines",label:"Airlines",icon:"‚úàÔ∏è"},{id:"alerts",label:"Alerts",icon:"‚ö†Ô∏è"},{id:"civic",label:"Civic",icon:"üèõÔ∏è"}],o=s.upAhead?.ranking?.[l]||{},c=a=>{const v=a==="positive"?s.upAhead?.keywords?.[l]:s.upAhead?.keywords?.[`${l}_negative`];return v&&v.length>0?v:(a==="positive"?H.upAhead.keywords[l]:H.upAhead.keywords[`${l}_negative`])||[]},M=c("positive"),k=c("negative"),K=()=>{const a=s.upAhead?.keywords?.negative;return a&&a.length>0?a:H.upAhead.keywords.negative||[]},P=K(),O={enabled:s.upAhead?.categories?.[l]!==!1,positiveMultiplier:o.positiveMultiplier||1,negativeMultiplier:o.negativeMultiplier||1,filterThreshold:o.filterThreshold||0,positiveKeywords:M,negativeKeywords:[...P,...k]},U=(a,v)=>{a==="enabled"?i(`upAhead.categories.${l}`,v):(a==="positiveMultiplier"||a==="negativeMultiplier"||a==="filterThreshold")&&i(`upAhead.ranking.${l}.${a}`,v)},V=(a,v)=>{if(!v||!v.trim())return;const B=v.trim();if(a==="positiveKeywords"){const z=c("positive");if(z.some(N=>N.toLowerCase()===B.toLowerCase()))return;i(`upAhead.keywords.${l}`,[...z,B])}else if(a==="negativeKeywords"){const z=c("negative");if(z.some(N=>N.toLowerCase()===B.toLowerCase()))return;i(`upAhead.keywords.${l}_negative`,[...z,B])}},_=(a,v)=>{if(a==="positiveKeywords"){const z=c("positive").filter(N=>N!==v);i(`upAhead.keywords.${l}`,z)}else if(a==="negativeKeywords"){const B=c("negative");if(B.includes(v)){const z=B.filter(N=>N!==v);i(`upAhead.keywords.${l}_negative`,z)}else{const z=K();if(z.includes(v)&&window.confirm(`"${v}" is a global negative keyword. Remove it from ALL categories?`)){const N=z.filter(G=>G!==v);i("upAhead.keywords.negative",N)}}}};return e.jsxs("div",{style:{display:"flex",height:"100%",gap:"10px"},children:[e.jsx("div",{style:{width:"70px",flexShrink:0,display:"flex",flexDirection:"column",gap:"5px"},children:d.map(a=>e.jsxs("button",{onClick:()=>T(a.id),style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"8px 4px",border:"none",background:l===a.id?"var(--accent-primary)":"rgba(255,255,255,0.05)",color:l===a.id?"#fff":"var(--text-secondary)",borderRadius:"8px",cursor:"pointer",fontSize:"0.7rem",fontWeight:500},children:[e.jsx("span",{style:{fontSize:"1.3rem",marginBottom:"2px"},children:a.icon}),a.label]},a.id))}),e.jsxs("div",{style:{flex:1,overflowY:"auto"},children:[e.jsx(j,{icon:"üåç",title:"Global Config"}),e.jsxs(w,{children:[e.jsx("div",{className:"settings-item__label",style:{marginBottom:"5px"},children:"Locations"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"15px"},children:["Chennai","Muscat","Trichy"].map(a=>e.jsxs("label",{className:`chip-checkbox ${s.upAhead?.locations?.includes(a)?"active":""}`,children:[e.jsx("input",{type:"checkbox",style:{display:"none"},checked:s.upAhead?.locations?.includes(a)||!1,onChange:v=>{const B=s.upAhead?.locations||[],z=v.target.checked?[...B,a]:B.filter(N=>N!==a);i("upAhead.locations",z)}}),a]},a))})]}),e.jsx(J,{title:d.find(a=>a.id===l).label,icon:d.find(a=>a.id===l).icon,configData:O,customUpdate:U,customAdd:V,customRemove:_,localInputs:I,handleLocalInput:L,subTab:`ua_${l}`})]})]})};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"15px",padding:"0 15px",flexShrink:0},children:[e.jsx("button",{className:`btn ${y==="main"?"btn--primary":"btn--secondary"}`,onClick:()=>r("main"),style:{flex:1},children:"‚öôÔ∏è Main"}),e.jsx("button",{className:`btn ${y==="buzz"?"btn--primary":"btn--secondary"}`,onClick:()=>r("buzz"),style:{flex:1},children:"‚ö° Buzz"}),e.jsx("button",{className:`btn ${y==="upahead"?"btn--primary":"btn--secondary"}`,onClick:()=>r("upahead"),style:{flex:1},children:"üóìÔ∏è Up Ahead"})]}),e.jsxs("div",{className:"settings-tab-content",style:{flex:1,overflowY:"auto",overflowX:"hidden",padding:"0 15px 15px 15px"},children:[y==="main"&&W(),y==="buzz"&&E(),y==="upahead"&&x()]})]})},J=({title:s,icon:i,configPath:m,configData:p,updateNested:A,addToList:y,removeFromList:r,localInputs:h,handleLocalInput:C,subTab:l,customUpdate:T,customAdd:I,customRemove:R})=>{const L=(x,d)=>{T?T(x,d):A(`${m}.${x}`,d)},W=(x,d)=>{I?I(x,d):y(`${m}.${x}`,d)},E=(x,d)=>{R?R(x,d):r(`${m}.${x}`,d)};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx(j,{icon:i,title:s}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:p.enabled!==!1?"Active":"Disabled"}),e.jsx(F,{checked:p.enabled!==!1,onChange:x=>L("enabled",x)})]})]}),e.jsxs(w,{children:[e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginBottom:"15px"},children:[e.jsx("strong",{children:"Ranking Formula:"})," (Positive Matches √ó Multiplier) ‚Äî (Negative Matches √ó Multiplier)"]}),e.jsxs("div",{style:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("div",{style:{fontWeight:600,color:"#81c784"},children:"‚úÖ Positive Boost"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",background:"rgba(0,0,0,0.3)",padding:"4px 8px",borderRadius:"6px"},children:[e.jsxs("span",{style:{fontSize:"0.75rem",color:"#fff"},children:["Multi: ",e.jsxs("strong",{children:[p.positiveMultiplier||1,"x"]})]}),e.jsx("input",{type:"range",min:"0",max:"5",step:"0.1",value:p.positiveMultiplier||1,onChange:x=>L("positiveMultiplier",parseFloat(x.target.value)),style:{width:"80px"}})]})]}),e.jsx($,{label:"",placeholder:"Add positive keyword...",value:h[`${l}_pos`]||"",onChange:x=>C(`${l}_pos`,x),onAdd:()=>{W("positiveKeywords",h[`${l}_pos`]),C(`${l}_pos`,"")},items:p.positiveKeywords||[],onRemove:x=>E("positiveKeywords",x)})]}),e.jsxs("div",{style:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid rgba(244, 67, 54, 0.3)",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("div",{style:{fontWeight:600,color:"#e57373"},children:"üö´ Negative Penalty"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",background:"rgba(0,0,0,0.3)",padding:"4px 8px",borderRadius:"6px"},children:[e.jsxs("span",{style:{fontSize:"0.75rem",color:"#fff"},children:["Multi: ",e.jsxs("strong",{children:[p.negativeMultiplier||1,"x"]})]}),e.jsx("input",{type:"range",min:"0",max:"5",step:"0.1",value:p.negativeMultiplier||1,onChange:x=>L("negativeMultiplier",parseFloat(x.target.value)),style:{width:"80px"}})]})]}),e.jsx($,{label:"",placeholder:"Add negative keyword...",value:h[`${l}_neg`]||"",onChange:x=>C(`${l}_neg`,x),onAdd:()=>{W("negativeKeywords",h[`${l}_neg`]),C(`${l}_neg`,"")},items:p.negativeKeywords||[],onRemove:x=>E("negativeKeywords",x)})]}),e.jsx(b,{label:"üõ°Ô∏è Filter Threshold",subLabel:`Hide if Score < ${p.filterThreshold||0}`,children:e.jsx("input",{type:"range",min:"-5",max:"5",step:"1",value:p.filterThreshold||0,onChange:x=>L("filterThreshold",parseInt(x.target.value)),style:{width:"100%"}})})]})]})},j=({icon:s,title:i})=>e.jsxs("div",{className:"section-title",children:[e.jsx("span",{children:s})," ",i]}),w=({children:s})=>e.jsx("div",{className:"settings-card",children:s}),b=({label:s,subLabel:i,children:m})=>e.jsxs("div",{className:"settings-item",children:[e.jsxs("div",{className:"settings-item__label",children:[e.jsx("span",{children:s}),i&&e.jsx("small",{children:i})]}),e.jsx("div",{style:{flex:"0 0 auto",marginLeft:"10px"},children:m})]}),$=({label:s,placeholder:i,value:m,onChange:p,onAdd:A,items:y,onRemove:r})=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{className:"settings-item__label",style:{marginBottom:"6px"},children:s}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[e.jsx("input",{type:"text",value:m,onChange:h=>p(h.target.value),placeholder:i,className:"settings-input",onKeyDown:h=>h.key==="Enter"&&A()}),e.jsx("button",{className:"btn btn--secondary",onClick:A,style:{padding:"0 15px"},children:"Add"})]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:[y.map((h,C)=>e.jsxs("span",{className:"keyword-chip",children:[h,e.jsx("button",{onClick:()=>r(h),children:"√ó"})]},C)),y.length===0&&e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Default keywords only"})]})]});export{xe as default};
//# sourceMappingURL=SettingsPage-DXe7KCMI.js.map
