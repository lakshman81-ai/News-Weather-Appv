{"version":3,"file":"Header-wyIJ1Xr8.js","sources":["../../src/components/MarketTicker.jsx","../../src/components/ThemeToggle.jsx","../../src/components/Header.jsx"],"sourcesContent":["import React, { useEffect, useRef, useMemo } from 'react';\nimport { useMarket } from '../context/MarketContext';\nimport './MarketTicker.css';\n\nconst MarketTicker = ({ loadingPhase }) => {\n    const { marketData, loading, lastFetch } = useMarket();\n    const scrollRef = useRef(null);\n    const isPaused = useRef(false);\n\n    // Filter and prepare market items\n    const markets = useMemo(() => {\n        if (!marketData) return [];\n\n        const { indices = [], commodities = [] } = marketData;\n        const allItems = [...indices, ...commodities];\n\n        // Specific items to display in order (Removed Currencies as requested)\n        // Including variations like \"NSE 50\" or \"50\" to catch them and rename\n        const allowedNames = ['NIFTY 50', 'NSE 50', '50', 'SENSEX', 'BSE SENSEX', 'Gold', 'Silver'];\n\n        return allowedNames\n            .map(name => allItems.find(item => item.name === name))\n            .filter(Boolean);\n    }, [marketData]);\n\n    // Auto-scroll logic (Same as before)\n    useEffect(() => {\n        let animationFrameId;\n        let lastTimestamp = 0;\n        const speed = 40; // pixels per second\n        let accumulator = 0;\n\n        const scroll = (timestamp) => {\n            if (!lastTimestamp) lastTimestamp = timestamp;\n            const deltaTime = timestamp - lastTimestamp;\n            lastTimestamp = timestamp;\n\n            if (scrollRef.current && !isPaused.current) {\n                const move = (speed * deltaTime) / 1000;\n                accumulator += move;\n\n                if (accumulator >= 1) {\n                    const pixelsToMove = Math.floor(accumulator);\n                    accumulator -= pixelsToMove;\n\n                    const { scrollLeft, scrollWidth } = scrollRef.current;\n\n                    // Reset if passed halfway point (infinite loop illusion)\n                    if (scrollLeft >= scrollWidth / 2) {\n                         scrollRef.current.scrollLeft = 0;\n                    } else {\n                         scrollRef.current.scrollLeft += pixelsToMove;\n                    }\n                }\n            } else {\n                lastTimestamp = timestamp;\n            }\n            animationFrameId = requestAnimationFrame(scroll);\n        };\n\n        const timeoutId = setTimeout(() => {\n            animationFrameId = requestAnimationFrame(scroll);\n        }, 1000);\n\n        return () => {\n            cancelAnimationFrame(animationFrameId);\n            clearTimeout(timeoutId);\n        };\n    }, [markets]);\n\n    const isItemStale = (item) => {\n        if (!item.timestamp) return true;\n        const now = Date.now();\n        const diff = now - item.timestamp;\n\n        // Commodities: 60 mins, Others: 15 mins\n        const isCommodity = ['Gold', 'Silver', 'Crude Oil'].includes(item.name);\n        const threshold = isCommodity ? 60 * 60 * 1000 : 15 * 60 * 1000;\n\n        return diff > threshold;\n    };\n\n    const formatTime = (ts) => {\n        if (!ts) return '';\n        return new Date(ts).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    };\n\n    const getDisplayName = (name) => {\n        if (name === 'NSE 50' || name === '50') return 'NIFTY 50';\n        if (name === 'BSE SENSEX') return 'SENSEX';\n        return name;\n    };\n\n    // Progress Visualization based on loadingPhase\n    const getPhaseStyle = () => {\n        // Phase 1 (Local): Light Green\n        // Phase 2 (Static): Medium Green\n        // Phase 3 (Live): Dark Green (or complete)\n        // We use a bottom border or background tint to show progress unobtrusively\n        if (!loadingPhase) return {};\n\n        let color = 'transparent';\n        if (loadingPhase === 1) color = 'rgba(144, 238, 144, 0.2)'; // Light Green\n        else if (loadingPhase === 2) color = 'rgba(60, 179, 113, 0.2)'; // Medium Sea Green\n        else if (loadingPhase === 3) color = 'rgba(34, 139, 34, 0.2)'; // Forest Green (Done)\n\n        return {\n            background: `linear-gradient(to bottom, transparent, ${color})`,\n            transition: 'background 0.5s ease'\n        };\n    };\n\n    if ((loading && markets.length === 0) || markets.length === 0) return null;\n\n    return (\n        <div className=\"market-ticker-container\" style={getPhaseStyle()}>\n            <div className=\"ticker-label\">üìà</div>\n\n            <div\n                className=\"ticker-track-wrapper\"\n                ref={scrollRef}\n                onMouseEnter={() => isPaused.current = true}\n                onMouseLeave={() => isPaused.current = false}\n                onTouchStart={() => isPaused.current = true}\n                onTouchEnd={() => isPaused.current = false}\n            >\n                <div className=\"ticker-track\">\n                    {/* Double the list for infinite scroll effect */}\n                    {[...markets, ...markets].map((item, index) => {\n                        const stale = isItemStale(item);\n                        return (\n                            <div key={`${item.name}-${index}`} className={`ticker-item ${stale ? 'stale-data' : ''}`}>\n                                <span className=\"ticker-name\">{getDisplayName(item.name)}</span>\n                                <span className=\"ticker-price\">\n                                    {/* Handle unit display for commodities */}\n                                    {item.name === 'Gold' || item.name === 'Silver' ? item.value :\n                                     (typeof item.value === 'number' ? item.value.toFixed(2) : item.value)}\n                                    {item.unit ? <span style={{fontSize: '0.7em', marginLeft: '2px'}}>{item.unit}</span> : ''}\n                                </span>\n                                <span className={`ticker-change ${parseFloat(item.change) >= 0 ? 'positive' : 'negative'}`}>\n                                    {parseFloat(item.change) >= 0 ? '‚ñ≤' : '‚ñº'} {Math.abs(parseFloat(item.changePercent)).toFixed(2)}%\n                                </span>\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n\n            {/* Static Last Updated Label */}\n            {lastFetch && (\n                <div className=\"ticker-updated\">\n                    <span style={{marginRight: '4px'}}>üïí</span> {formatTime(lastFetch)}\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default MarketTicker;\n","import React from 'react';\nimport { useSettings } from '../context/SettingsContext';\n\nconst ThemeToggle = () => {\n    const { settings, updateSettings } = useSettings();\n    const isLight = settings.theme === 'light';\n\n    const toggleTheme = () => {\n        updateSettings({ ...settings, theme: isLight ? 'dark' : 'light' });\n    };\n\n    return (\n        <button\n            onClick={toggleTheme}\n            className=\"header__action-btn\"\n            title={isLight ? \"Switch to Dark Mode\" : \"Switch to Light Mode\"}\n            style={{\n                background: 'transparent',\n                border: 'none',\n                cursor: 'pointer',\n                padding: '0 8px',\n                color: 'var(--text-primary)'\n            }}\n        >\n            {isLight ? 'üåô' : '‚òÄÔ∏è'}\n        </button>\n    );\n};\n\nexport default ThemeToggle;\n","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport MarketTicker from './MarketTicker';\nimport ThemeToggle from './ThemeToggle';\n\n/**\n * Header Component with optional back navigation\n */\nfunction Header({ title, icon, showBack = false, backTo = '/', actions, pills, activePill, onPillChange, compact = false, loadingPhase }) {\n    const [isDesktop, setIsDesktop] = useState(window.innerWidth >= 1024);\n\n    useEffect(() => {\n        const handleResize = () => setIsDesktop(window.innerWidth >= 1024);\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    // Icon Mapping helper\n    const getPillIcon = (pillName) => {\n        if (pillName.includes('Morning')) return 'üåÖ';\n        if (pillName.includes('Midday')) return '‚òÄÔ∏è';\n        if (pillName.includes('Evening')) return 'üåô';\n        return pillName;\n    };\n\n    return (\n        <header className={`header ${compact ? 'header--compact' : ''}`}>\n            {/* Left Side: Back or Theme Toggle (PC Only) */}\n            {showBack ? (\n                <Link to={backTo} className=\"header__back\">\n                    <span>‚Üê</span>\n                    <span>{title}</span>\n                </Link>\n            ) : (\n                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>\n                    {isDesktop && <ThemeToggle />}\n                    <h1 className=\"header__title\">\n                        {/* Icon removed as requested */}\n                    </h1>\n                </div>\n            )}\n\n            {!showBack && <MarketTicker loadingPhase={loadingPhase} />}\n\n            {/* Contextual Pills (Classic Mode) */}\n            {pills && (\n                <div className=\"header__pills\">\n                    {pills.map((pill) => (\n                        <button\n                            key={pill}\n                            className={`time-pill time-pill--matte ${activePill === pill ? 'time-pill--active' : ''}`}\n                            onClick={() => onPillChange && onPillChange(pill)}\n                            title={pill}\n                        >\n                            {getPillIcon(pill)}\n                        </button>\n                    ))}\n                </div>\n            )}\n\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                {actions}\n            </div>\n        </header>\n    );\n}\n\nexport default Header;\n"],"names":["MarketTicker","loadingPhase","marketData","loading","lastFetch","useMarket","scrollRef","useRef","isPaused","markets","useMemo","indices","commodities","allItems","name","item","useEffect","animationFrameId","lastTimestamp","speed","accumulator","scroll","timestamp","deltaTime","move","pixelsToMove","scrollLeft","scrollWidth","timeoutId","isItemStale","diff","threshold","formatTime","ts","getDisplayName","getPhaseStyle","color","jsx","index","stale","jsxs","ThemeToggle","settings","updateSettings","useSettings","isLight","toggleTheme","Header","title","icon","showBack","backTo","actions","pills","activePill","onPillChange","compact","isDesktop","setIsDesktop","useState","handleResize","getPillIcon","pillName","Link","pill"],"mappings":"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"}